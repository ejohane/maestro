{"id":"maestro-slm","title":"Project List: Add and Manage Projects via Remote Filesystem Browser","description":"## Overview\n\nImplement the project list view - the main entry point to Maestro. This replaces the current mock data with a real persistence layer and adds a custom folder browser for adding projects from the server's filesystem.\n\n## Background \u0026 Context\n\n### Why This Matters\nMaestro is a mobile-friendly web frontend for OpenCode that runs on a user's dev machine and is accessed remotely via Tailscale. The project list is the **first screen users see** and the **foundation for all other features**. Without real project persistence, nothing else in Maestro can function - you can't view epics, run swarms, or do anything useful.\n\n### Technical Constraint: Remote Access\nBecause Maestro runs as a Next.js server on the dev machine but is accessed from remote clients (phone, tablet, another laptop via Tailscale):\n- **Browser file picker APIs won't work** - they open on the client device, not the server\n- **We need a custom server-side folder browser** that exposes the server's filesystem\n- **All storage is server-side** - config lives at `~/.maestro/config.json` on the dev machine\n\n### Current State\n- `src/app/page.tsx` displays mock projects from `src/lib/data/mock.ts`\n- `src/components/ui/sidebar.tsx` also uses mock data\n- No API routes exist yet\n- No persistence layer exists\n\n### Target State\n- Real project storage in `~/.maestro/config.json`\n- Full CRUD API for projects\n- Filesystem browsing API (constrained to home directory)\n- Folder browser modal for adding projects\n- Project card management (edit name, remove, relocate missing)\n- Proper loading/error states throughout\n\n## Design Decisions\n\n### UUID-based Project IDs\nProjects get UUID v4 identifiers used in routing (`/project/[id]`). This decouples the URL from the filesystem path, allowing projects to be relocated without breaking links.\n\n### Display Name Derivation\nWhen no custom name is set, derive from path: `/Users/erik/dev/my-project` â†’ `my-project`. Keep it simple; users can override.\n\n### Path Display Format\nShow `~/dev/project` in UI, store `/Users/erik/dev/project` internally. Display-only transformation.\n\n### Security Boundary\nAll filesystem operations constrained to user's home directory. No browsing `/etc`, `/usr`, etc.\n\n### Missing Project Detection\nOn each API call, validate paths still exist. Missing projects get `status: \"missing\"` and show warning UI with relocate/remove options.\n\n## API Design Summary\n\n- `GET /api/projects` - List all with computed fields (displayName, displayPath, status)\n- `POST /api/projects` - Add new (validates path exists, is directory, in home, not duplicate)\n- `PATCH /api/projects/:id` - Update name or relocate path\n- `DELETE /api/projects/:id` - Remove from tracking (not from disk)\n- `GET /api/filesystem/browse?path=` - List directories for folder picker\n\n## UI Components Summary\n\n- **Project List Page**: Replace mock data with API, add empty/loading/error states, add \"Add Project\" button\n- **Folder Browser Modal**: Navigate server filesystem, show git indicators, path input for power users\n- **Project Card Actions**: Edit name, remove, relocate missing\n- **Sidebar Integration**: Fetch from API, \"+\" button opens folder browser\n\n## Success Criteria (Definition of Done)\nSee GitHub issue #1 for full checklist. Key items:\n- Config auto-created on first use\n- Full CRUD for projects working\n- Missing project detection and relocation\n- Folder browser with git repo indicators\n- Mobile-friendly (touch targets, scrollable breadcrumbs)\n- All states (loading, error, empty) implemented\n\n## References\n- GitHub Issue: #1\n- SCOPE.md: Project overview and architecture\n- AGENTS.md: Development workflow guidelines","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-30T07:55:02.722791-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:55:02.722791-06:00"}
{"id":"maestro-slm.1","title":"1.1 Create config service for ~/.maestro/config.json","description":"## Purpose\nCreate the persistence layer for Maestro's project configuration. This service handles reading/writing `~/.maestro/config.json` and provides type-safe access to project data.\n\n## Why a Dedicated Service?\n1. **Single source of truth** - All config access goes through one place\n2. **Auto-initialization** - Creates `~/.maestro/` and `config.json` on first use\n3. **Type safety** - TypeScript interfaces for all data structures\n4. **Error handling** - Graceful handling of missing/corrupted files\n5. **Path utilities** - Centralized logic for home directory, path display, etc.\n\n## Config File Location\n```\n~/.maestro/config.json\n```\nUse `os.homedir()` to resolve `~`. This is the home of the user running the Next.js server.\n\n## Config Schema\n```typescript\n// src/lib/types/config.ts\ninterface MaestroConfig {\n  projects: ProjectConfig[];\n}\n\ninterface ProjectConfig {\n  id: string;          // UUID v4\n  path: string;        // Absolute path: /Users/erik/dev/project\n  name: string | null; // Custom display name, null = derive from path\n  addedAt: string;     // ISO 8601 timestamp\n}\n```\n\n## Service API\n```typescript\n// src/lib/services/config.ts\nclass ConfigService {\n  // Core operations\n  async getConfig(): Promise\u003cMaestroConfig\u003e\n  async saveConfig(config: MaestroConfig): Promise\u003cvoid\u003e\n  \n  // Project helpers\n  async getProjects(): Promise\u003cProjectConfig[]\u003e\n  async getProject(id: string): Promise\u003cProjectConfig | null\u003e\n  async addProject(path: string, name?: string): Promise\u003cProjectConfig\u003e\n  async updateProject(id: string, updates: Partial\u003cProjectConfig\u003e): Promise\u003cProjectConfig\u003e\n  async deleteProject(id: string): Promise\u003cvoid\u003e\n  \n  // Path utilities\n  getHomeDir(): string\n  toDisplayPath(absolutePath: string): string  // /Users/erik/dev â†’ ~/dev\n  toAbsolutePath(displayPath: string): string  // ~/dev â†’ /Users/erik/dev\n  deriveDisplayName(path: string): string      // /Users/erik/dev/foo â†’ foo\n  isWithinHome(path: string): boolean          // Security check\n}\n```\n\n## Implementation Notes\n\n### Auto-initialization\n```typescript\nasync getConfig(): Promise\u003cMaestroConfig\u003e {\n  const configPath = path.join(os.homedir(), '.maestro', 'config.json');\n  try {\n    const content = await fs.readFile(configPath, 'utf-8');\n    return JSON.parse(content);\n  } catch (err) {\n    if (err.code === 'ENOENT') {\n      // First run - create default config\n      const defaultConfig = { projects: [] };\n      await this.saveConfig(defaultConfig);\n      return defaultConfig;\n    }\n    throw err;\n  }\n}\n```\n\n### Directory Creation\n```typescript\nasync saveConfig(config: MaestroConfig): Promise\u003cvoid\u003e {\n  const dir = path.join(os.homedir(), '.maestro');\n  await fs.mkdir(dir, { recursive: true }); // No-op if exists\n  await fs.writeFile(\n    path.join(dir, 'config.json'),\n    JSON.stringify(config, null, 2)\n  );\n}\n```\n\n### UUID Generation\nUse `crypto.randomUUID()` (built into Node.js 19+) or install `uuid` package.\n\n## Edge Cases\n- **Corrupted JSON**: Throw clear error, let API layer handle (could offer reset option later)\n- **Permission denied**: Throw, user needs to fix permissions\n- **Concurrent writes**: Last write wins (acceptable for v1, single user)\n- **Symlinks in path**: Resolve with `fs.realpath()` before storing\n\n## Acceptance Criteria\n- [ ] `~/.maestro/` directory created automatically\n- [ ] `config.json` created with empty projects array on first access\n- [ ] All CRUD operations work correctly\n- [ ] Path utility functions work correctly\n- [ ] Security check rejects paths outside home directory\n- [ ] Type definitions exported for use by API routes\n\n## Dependencies\n- Task 7.2 (React Query) should ideally be done first, but this can proceed in parallel as it's server-side only\n\n## Files\n- `src/lib/types/config.ts` (new) - Type definitions\n- `src/lib/services/config.ts` (new) - Service implementation","status":"open","priority":0,"issue_type":"task","created_at":"2025-12-30T07:55:02.793402-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:55:35.535086-06:00","dependencies":[{"issue_id":"maestro-slm.1","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:02.795553-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.10","title":"4.1 Update project list page to fetch from API","description":"## Purpose\nUpdate the project list page (`src/app/page.tsx`) to fetch real data from the API instead of using mock data. This is the core integration that makes the project list functional.\n\n## Current State\n```typescript\n// Current - uses mock data\nimport { mockProjects } from \"@/lib/data/mock\";\n// ...\n{mockProjects.map((project) =\u003e (\n```\n\n## Target State\n```typescript\n// Target - fetches from API\nimport { useProjects } from \"@/lib/hooks/useProjects\";\n// ...\nconst { data: projects, isLoading, error } = useProjects();\n// Handle loading, error, empty states\n// Map over real projects\n```\n\n## Changes Required\n\n### 1. Import useProjects hook\n```typescript\nimport { useProjects } from \"@/lib/hooks/useProjects\";\n```\n\n### 2. Replace mock data with hook\n```typescript\nexport default function ProjectListPage() {\n  const { data: projects, isLoading, error, refetch } = useProjects();\n  \n  // ... render based on state\n}\n```\n\n### 3. Update project card rendering\nThe API returns a slightly different shape than mock data:\n- `displayName` instead of `name` (computed field)\n- `displayPath` instead of `path` for display\n- `status` field for missing detection\n- No `activeSwarms`, `inProgress`, `lastActivity` yet (placeholders)\n\n```typescript\n{projects?.map((project) =\u003e (\n  \u003cLink \n    key={project.id} \n    href={`/project/${project.id}`}\n    className={cn(\n      \"flex items-center gap-3 px-3 py-2.5 hover:bg-secondary/50 transition-colors\",\n      project.status === \"missing\" \u0026\u0026 \"opacity-60\"\n    )}\n  \u003e\n    {/* ... */}\n    \u003cspan className=\"font-medium text-sm\"\u003e{project.displayName}\u003c/span\u003e\n    \u003cp className=\"text-xs text-muted-foreground font-mono truncate\"\u003e\n      {project.displayPath}\n    \u003c/p\u003e\n    {/* ... */}\n  \u003c/Link\u003e\n))}\n```\n\n### 4. Handle loading state\nShow skeleton cards while loading:\n```typescript\nif (isLoading) {\n  return (\n    \u003cdiv className=\"border border-border rounded-md overflow-hidden divide-y divide-border\"\u003e\n      {[1, 2, 3].map((i) =\u003e (\n        \u003cProjectCardSkeleton key={i} /\u003e\n      ))}\n    \u003c/div\u003e\n  );\n}\n```\n\n### 5. Handle error state\nShow error with retry:\n```typescript\nif (error) {\n  return (\n    \u003cdiv className=\"text-center py-8\"\u003e\n      \u003cp className=\"text-destructive mb-2\"\u003eFailed to load projects\u003c/p\u003e\n      \u003cButton variant=\"outline\" onClick={() =\u003e refetch()}\u003e\n        Retry\n      \u003c/Button\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n### 6. Handle empty state\nWhen no projects exist:\n```typescript\nif (!projects?.length) {\n  return \u003cNoProjectsEmptyState onAddProject={openFolderBrowser} /\u003e;\n}\n```\n\n(Empty state component is separate task 4.2)\n\n## Placeholder Data\nUntil we integrate with OpenCode for activity data, use static placeholders:\n- `activeSwarms`: 0 (or hide indicator)\n- `inProgress`: 0 (or hide indicator)\n- `lastActivity`: Show `addedAt` date formatted, or hide\n\n## Type Updates\nCreate or update types to match API response:\n```typescript\n// Can use types from useProjects hook\ninterface Project {\n  id: string;\n  path: string;\n  displayPath: string;\n  name: string | null;\n  displayName: string;\n  addedAt: string;\n  status: \"active\" | \"missing\";\n}\n```\n\n## Acceptance Criteria\n- [ ] Fetches projects from GET /api/projects\n- [ ] Renders project cards with displayName and displayPath\n- [ ] Handles loading state with skeletons\n- [ ] Handles error state with retry button\n- [ ] Empty check (for task 4.2 empty state)\n- [ ] Clicking project navigates to /project/[id]\n- [ ] Missing projects shown with different styling\n- [ ] Remove import of mockProjects\n\n## Dependencies\n- **Requires**: Task 7.1 (useProjects hook)\n- **Requires**: Task 7.2 (React Query provider)\n- **Requires**: Tasks 1.2 (GET /api/projects endpoint)\n\n## Files\n- `src/app/page.tsx` (modify)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-30T07:55:03.30898-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:58:38.544652-06:00","dependencies":[{"issue_id":"maestro-slm.10","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.309535-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.11","title":"4.2 Add empty state to project list page","description":"## Purpose\nCreate a compelling empty state for when users first open Maestro with no projects configured. This is the first impression for new users and should guide them to add their first project.\n\n## Visual Design\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                                                 â”‚\nâ”‚                   [folder icon]                 â”‚\nâ”‚                                                 â”‚\nâ”‚              No projects yet                    â”‚\nâ”‚                                                 â”‚\nâ”‚     Add a project folder to get started         â”‚\nâ”‚                                                 â”‚\nâ”‚            [ + Add Project ]                    â”‚\nâ”‚                                                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## Component\n```typescript\n// src/components/empty-states/NoProjects.tsx\nimport { Folder, Plus } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\n\ninterface NoProjectsProps {\n  onAddProject: () =\u003e void;\n}\n\nexport function NoProjects({ onAddProject }: NoProjectsProps) {\n  return (\n    \u003cdiv className=\"flex flex-col items-center justify-center py-16 px-4 text-center\"\u003e\n      {/* Icon */}\n      \u003cdiv className=\"w-16 h-16 rounded-full bg-secondary flex items-center justify-center mb-6\"\u003e\n        \u003cFolder className=\"h-8 w-8 text-muted-foreground\" /\u003e\n      \u003c/div\u003e\n      \n      {/* Heading */}\n      \u003ch2 className=\"text-lg font-semibold mb-2\"\u003eNo projects yet\u003c/h2\u003e\n      \n      {/* Description */}\n      \u003cp className=\"text-sm text-muted-foreground mb-6 max-w-sm\"\u003e\n        Add a project folder to get started. Maestro will help you manage ideas, \n        plan tasks, and run agent swarms.\n      \u003c/p\u003e\n      \n      {/* CTA */}\n      \u003cButton onClick={onAddProject}\u003e\n        \u003cPlus className=\"h-4 w-4 mr-2\" /\u003e\n        Add Project\n      \u003c/Button\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n## Integration with page.tsx\n```typescript\n// In ProjectListPage\nconst [folderBrowserOpen, setFolderBrowserOpen] = useState(false);\n\n// ...\n\nif (!projects?.length) {\n  return (\n    \u003c\u003e\n      \u003cNoProjects onAddProject={() =\u003e setFolderBrowserOpen(true)} /\u003e\n      \u003cFolderBrowserModal \n        open={folderBrowserOpen} \n        onOpenChange={setFolderBrowserOpen}\n      /\u003e\n    \u003c/\u003e\n  );\n}\n```\n\n## Design Considerations\n\n### Illustration vs Icon\nFor v1, use a simple folder icon. Could upgrade to a custom illustration later, but icon is faster to implement and still looks good.\n\n### Copy\n- Keep it short and friendly\n- \"No projects yet\" - clear state\n- \"Add a project folder to get started\" - clear action\n- Additional context about what Maestro does - helps new users understand value\n\n### Button\n- Use primary button for strong CTA\n- Include icon for visual clarity\n- Same action as header \"Add Project\" button\n\n## Mobile Behavior\n- Centered layout works well on all screen sizes\n- Adequate padding on mobile\n- Touch-friendly button\n\n## Accessibility\n- Heading hierarchy (h2)\n- Button has clear label\n- Icon is decorative (no aria-label needed)\n\n## Acceptance Criteria\n- [ ] Shows when projects array is empty\n- [ ] Displays folder icon\n- [ ] Shows \"No projects yet\" heading\n- [ ] Shows helpful description text\n- [ ] \"Add Project\" button opens folder browser modal\n- [ ] Centered layout\n- [ ] Mobile-friendly\n\n## Dependencies\n- **Requires**: Task 3.3 (FolderBrowserModal)\n- **Used by**: Task 4.1 (project list page integration)\n\n## Files\n- `src/components/empty-states/NoProjects.tsx` (new)\n- `src/app/page.tsx` (integrate)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T07:55:03.369725-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:58:52.639877-06:00","dependencies":[{"issue_id":"maestro-slm.11","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.370201-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.12","title":"4.3 Add loading and error states to project list","description":"## Purpose\nAdd proper loading and error states to the project list page. Good loading/error UX is essential for a polished feel and helps users understand system state.\n\n## Loading State\n\n### Skeleton Cards\nShow placeholder cards that match the shape of real project cards:\n```typescript\nfunction ProjectCardSkeleton() {\n  return (\n    \u003cdiv className=\"flex items-center gap-3 px-3 py-2.5 animate-pulse\"\u003e\n      {/* Icon placeholder */}\n      \u003cdiv className=\"w-8 h-8 rounded-md bg-secondary\" /\u003e\n      \n      {/* Content placeholder */}\n      \u003cdiv className=\"flex-1 space-y-2\"\u003e\n        \u003cdiv className=\"h-4 w-32 bg-secondary rounded\" /\u003e\n        \u003cdiv className=\"h-3 w-48 bg-secondary rounded\" /\u003e\n      \u003c/div\u003e\n      \n      {/* Right side placeholder */}\n      \u003cdiv className=\"h-4 w-4 bg-secondary rounded\" /\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n### Integration\n```typescript\nif (isLoading) {\n  return (\n    \u003cdiv className=\"border border-border rounded-md overflow-hidden divide-y divide-border\"\u003e\n      \u003cProjectCardSkeleton /\u003e\n      \u003cProjectCardSkeleton /\u003e\n      \u003cProjectCardSkeleton /\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\nShow 3 skeleton cards as a reasonable default. This provides visual structure while loading without being jarring.\n\n## Error State\n\n### Error Display\n```typescript\nfunction ProjectListError({ message, onRetry }: { message: string; onRetry: () =\u003e void }) {\n  return (\n    \u003cdiv className=\"border border-border rounded-md p-8 text-center\"\u003e\n      {/* Error icon */}\n      \u003cdiv className=\"w-12 h-12 rounded-full bg-destructive/10 flex items-center justify-center mx-auto mb-4\"\u003e\n        \u003cAlertCircle className=\"h-6 w-6 text-destructive\" /\u003e\n      \u003c/div\u003e\n      \n      {/* Message */}\n      \u003ch3 className=\"font-medium mb-1\"\u003eFailed to load projects\u003c/h3\u003e\n      \u003cp className=\"text-sm text-muted-foreground mb-4\"\u003e{message}\u003c/p\u003e\n      \n      {/* Retry */}\n      \u003cButton variant=\"outline\" onClick={onRetry}\u003e\n        \u003cRefreshCw className=\"h-4 w-4 mr-2\" /\u003e\n        Try Again\n      \u003c/Button\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n### Integration\n```typescript\nif (error) {\n  return (\n    \u003cProjectListError \n      message={error.message} \n      onRetry={() =\u003e refetch()} \n    /\u003e\n  );\n}\n```\n\n## Error Scenarios\n- **Network error**: \"Failed to fetch\" - server might be down\n- **Server error**: 500 response - show generic message\n- **Config error**: Could indicate corrupted config file\n\nFor all cases, the retry button is the primary action. If errors persist, users should check the server logs.\n\n## Refetching State\nWhen data exists but is being refetched (background refresh), don't show loading state - keep showing current data. React Query handles this automatically with `isLoading` (initial load) vs `isFetching` (refetch).\n\n```typescript\n// Only show skeleton on initial load, not refetch\nif (isLoading) {\n  return \u003cSkeletonState /\u003e;\n}\n\n// Show error only if no cached data\nif (error \u0026\u0026 !projects) {\n  return \u003cErrorState /\u003e;\n}\n```\n\n## Page-Level Integration\n```typescript\nexport default function ProjectListPage() {\n  const { data: projects, isLoading, error, refetch } = useProjects();\n  const [folderBrowserOpen, setFolderBrowserOpen] = useState(false);\n\n  return (\n    \u003cdiv className=\"min-h-screen bg-background\"\u003e\n      {/* Header - always shown */}\n      \u003cheader\u003e...\u003c/header\u003e\n      \n      \u003cmain className=\"max-w-3xl mx-auto p-4\"\u003e\n        \u003cdiv className=\"mb-6\"\u003e\n          \u003ch1\u003eProjects\u003c/h1\u003e\n          \u003cp\u003eSelect a project to view swarms and sessions\u003c/p\u003e\n        \u003c/div\u003e\n        \n        {isLoading ? (\n          \u003cProjectListSkeleton /\u003e\n        ) : error \u0026\u0026 !projects ? (\n          \u003cProjectListError message={error.message} onRetry={refetch} /\u003e\n        ) : !projects?.length ? (\n          \u003cNoProjects onAddProject={() =\u003e setFolderBrowserOpen(true)} /\u003e\n        ) : (\n          \u003cProjectList projects={projects} /\u003e\n        )}\n      \u003c/main\u003e\n      \n      \u003cFolderBrowserModal \n        open={folderBrowserOpen}\n        onOpenChange={setFolderBrowserOpen}\n      /\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n## Acceptance Criteria\n- [ ] Loading skeleton shown during initial fetch\n- [ ] Skeleton matches shape of real cards\n- [ ] Error state shown when API fails\n- [ ] Error message displayed\n- [ ] Retry button triggers refetch\n- [ ] Refetch doesn't show loading state (keeps stale data)\n- [ ] Proper state hierarchy: loading â†’ error â†’ empty â†’ data\n\n## Dependencies\n- **Requires**: Task 4.1 (page using useProjects)\n- **Related**: Task 4.2 (empty state)\n\n## Files\n- `src/app/page.tsx` (add loading/error states)\n- Could extract: `src/components/project-list/ProjectCardSkeleton.tsx`\n- Could extract: `src/components/project-list/ProjectListError.tsx`","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T07:55:03.429006-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:59:11.538105-06:00","dependencies":[{"issue_id":"maestro-slm.12","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.429496-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.13","title":"4.4 Add 'Add Project' button to header - opens folder browser modal","description":"## Purpose\nAdd an \"Add Project\" button to the project list page header that opens the folder browser modal. This provides a consistent, always-visible entry point for adding projects.\n\n## Visual Design\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  âš¡ Maestro                              [Search] [+ Add]   â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\nThe button should be:\n- Visible in the header at all times\n- Compact but recognizable\n- Consistent with the empty state CTA\n\n## Current Header\n```typescript\n\u003cheader className=\"sticky top-0 z-50 border-b border-border bg-card\"\u003e\n  \u003cdiv className=\"flex h-12 items-center justify-between px-4\"\u003e\n    \u003cdiv className=\"flex items-center gap-2\"\u003e\n      \u003cZap /\u003e\n      \u003cspan\u003eMaestro\u003c/span\u003e\n    \u003c/div\u003e\n    \u003cdiv className=\"flex items-center gap-1\"\u003e\n      \u003cbutton\u003e[Search]\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n\u003c/header\u003e\n```\n\n## Updated Header\n```typescript\n\u003cheader className=\"sticky top-0 z-50 border-b border-border bg-card\"\u003e\n  \u003cdiv className=\"flex h-12 items-center justify-between px-4\"\u003e\n    \u003cdiv className=\"flex items-center gap-2\"\u003e\n      \u003cZap /\u003e\n      \u003cspan\u003eMaestro\u003c/span\u003e\n    \u003c/div\u003e\n    \u003cdiv className=\"flex items-center gap-2\"\u003e\n      \u003cbutton className=\"search-button\"\u003e[Search]\u003c/button\u003e\n      \u003cButton \n        size=\"sm\" \n        onClick={() =\u003e setFolderBrowserOpen(true)}\n      \u003e\n        \u003cPlus className=\"h-4 w-4 mr-1\" /\u003e\n        \u003cspan className=\"hidden sm:inline\"\u003eAdd\u003c/span\u003e\n      \u003c/Button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n\u003c/header\u003e\n```\n\n## Button Design\n- **Size**: Small (`size=\"sm\"`) to fit header\n- **Icon**: Plus icon always visible\n- **Text**: \"Add\" visible on larger screens, hidden on mobile (icon only)\n- **Style**: Primary button for emphasis\n\n## Mobile Behavior\nOn mobile:\n- Button shows only icon (plus)\n- Maintains adequate touch target (min 44x44 via padding)\n- Positioned where thumb can reach\n\n```typescript\n\u003cButton \n  size=\"sm\" \n  onClick={() =\u003e setFolderBrowserOpen(true)}\n  className=\"h-8 px-2 sm:px-3\"\n\u003e\n  \u003cPlus className=\"h-4 w-4\" /\u003e\n  \u003cspan className=\"hidden sm:inline ml-1\"\u003eAdd\u003c/span\u003e\n\u003c/Button\u003e\n```\n\n## State Management\nThe folder browser modal state is managed at the page level:\n```typescript\nexport default function ProjectListPage() {\n  const [folderBrowserOpen, setFolderBrowserOpen] = useState(false);\n  \n  return (\n    \u003c\u003e\n      \u003cheader\u003e\n        {/* ... */}\n        \u003cButton onClick={() =\u003e setFolderBrowserOpen(true)}\u003e\n          Add\n        \u003c/Button\u003e\n      \u003c/header\u003e\n      \n      {/* ... main content ... */}\n      \n      \u003cFolderBrowserModal \n        open={folderBrowserOpen}\n        onOpenChange={setFolderBrowserOpen}\n        onSuccess={() =\u003e {\n          // Optionally scroll to new project, show toast, etc.\n        }}\n      /\u003e\n    \u003c/\u003e\n  );\n}\n```\n\n## Success Callback\nAfter successfully adding a project:\n- Modal closes automatically\n- Projects list refetches (React Query invalidation)\n- Optionally show a success toast\n- New project appears at top of list (sorted by addedAt)\n\n## Acceptance Criteria\n- [ ] \"Add\" button visible in header\n- [ ] Button shows icon + text on desktop\n- [ ] Button shows icon only on mobile\n- [ ] Clicking opens folder browser modal\n- [ ] Modal closes on successful add\n- [ ] Project list updates after add\n- [ ] Button accessible via keyboard\n\n## Dependencies\n- **Requires**: Task 3.3 (FolderBrowserModal)\n- **Requires**: Task 7.1 (hooks for refetch after add)\n- **Part of**: Task 4.1 (overall page update)\n\n## Files\n- `src/app/page.tsx` (update header)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-30T07:55:03.487865-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:59:26.134722-06:00","dependencies":[{"issue_id":"maestro-slm.13","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.488336-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.14","title":"5.1 Add project card dropdown menu (edit name, remove)","description":"## Purpose\nAdd a dropdown menu to each project card that provides actions: \"Edit Name\" and \"Remove\". This enables users to manage existing projects without navigating away from the list.\n\n## Visual Design\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  ğŸ“ my-project                                          [â‹®] â”‚\nâ”‚     ~/dev/my-project                                        â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                                           â”‚\n                                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”\n                                                  â”‚  âœï¸ Edit Name   â”‚\n                                                  â”‚  ğŸ—‘ï¸ Remove      â”‚\n                                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## Component Structure\n```\nproject-card/\nâ”œâ”€â”€ ProjectCard.tsx       # Main card component\nâ”œâ”€â”€ ProjectCardMenu.tsx   # Dropdown menu\nâ”œâ”€â”€ EditNameDialog.tsx    # Edit dialog (Task 5.2)\nâ””â”€â”€ RelocateDialog.tsx    # Relocate dialog (Task 5.4)\n```\n\n## ProjectCard Component\nExtract the project card from page.tsx into a reusable component:\n```typescript\n// src/components/project-card/ProjectCard.tsx\ninterface ProjectCardProps {\n  project: Project;\n  onEdit: () =\u003e void;\n  onRemove: () =\u003e void;\n  onRelocate?: () =\u003e void;  // Only for missing projects\n}\n\nexport function ProjectCard({ project, onEdit, onRemove, onRelocate }: ProjectCardProps) {\n  const isMissing = project.status === \"missing\";\n  \n  return (\n    \u003cdiv className={cn(\n      \"flex items-center gap-3 px-3 py-2.5 transition-colors\",\n      isMissing ? \"opacity-60\" : \"hover:bg-secondary/50\"\n    )}\u003e\n      {/* Card content as link (except menu) */}\n      \u003cLink \n        href={isMissing ? \"#\" : `/project/${project.id}`}\n        className=\"flex items-center gap-3 flex-1 min-w-0\"\n        onClick={isMissing ? (e) =\u003e e.preventDefault() : undefined}\n      \u003e\n        \u003cdiv className=\"flex items-center justify-center w-8 h-8 rounded-md bg-secondary\"\u003e\n          \u003cFolder className=\"h-4 w-4 text-muted-foreground\" /\u003e\n        \u003c/div\u003e\n        \n        \u003cdiv className=\"flex-1 min-w-0\"\u003e\n          \u003cdiv className=\"flex items-center gap-2\"\u003e\n            \u003cspan className=\"font-medium text-sm\"\u003e{project.displayName}\u003c/span\u003e\n            {isMissing \u0026\u0026 (\n              \u003cspan className=\"text-xs text-warning\"\u003eMissing\u003c/span\u003e\n            )}\n          \u003c/div\u003e\n          \u003cp className=\"text-xs text-muted-foreground font-mono truncate\"\u003e\n            {project.displayPath}\n          \u003c/p\u003e\n        \u003c/div\u003e\n      \u003c/Link\u003e\n      \n      {/* Menu - not part of link */}\n      \u003cProjectCardMenu \n        project={project}\n        onEdit={onEdit}\n        onRemove={onRemove}\n        onRelocate={onRelocate}\n      /\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n## ProjectCardMenu Component\n```typescript\n// src/components/project-card/ProjectCardMenu.tsx\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { MoreVertical, Pencil, Trash2, FolderSearch } from \"lucide-react\";\n\ninterface ProjectCardMenuProps {\n  project: Project;\n  onEdit: () =\u003e void;\n  onRemove: () =\u003e void;\n  onRelocate?: () =\u003e void;\n}\n\nexport function ProjectCardMenu({ project, onEdit, onRemove, onRelocate }: ProjectCardMenuProps) {\n  const isMissing = project.status === \"missing\";\n  \n  return (\n    \u003cDropdownMenu\u003e\n      \u003cDropdownMenuTrigger asChild\u003e\n        \u003cbutton \n          className=\"h-8 w-8 flex items-center justify-center rounded-md hover:bg-secondary transition-colors\"\n          onClick={(e) =\u003e e.preventDefault()}  // Don't trigger card link\n        \u003e\n          \u003cMoreVertical className=\"h-4 w-4 text-muted-foreground\" /\u003e\n        \u003c/button\u003e\n      \u003c/DropdownMenuTrigger\u003e\n      \u003cDropdownMenuContent align=\"end\"\u003e\n        {isMissing \u0026\u0026 onRelocate \u0026\u0026 (\n          \u003cDropdownMenuItem onClick={onRelocate}\u003e\n            \u003cFolderSearch className=\"h-4 w-4 mr-2\" /\u003e\n            Relocate\n          \u003c/DropdownMenuItem\u003e\n        )}\n        \u003cDropdownMenuItem onClick={onEdit}\u003e\n          \u003cPencil className=\"h-4 w-4 mr-2\" /\u003e\n          Edit Name\n        \u003c/DropdownMenuItem\u003e\n        \u003cDropdownMenuItem \n          onClick={onRemove}\n          className=\"text-destructive focus:text-destructive\"\n        \u003e\n          \u003cTrash2 className=\"h-4 w-4 mr-2\" /\u003e\n          Remove\n        \u003c/DropdownMenuItem\u003e\n      \u003c/DropdownMenuContent\u003e\n    \u003c/DropdownMenu\u003e\n  );\n}\n```\n\n## Menu Actions\n| Action | Condition | Behavior |\n|--------|-----------|----------|\n| Relocate | Missing projects only | Opens folder browser to select new location |\n| Edit Name | Always | Opens edit dialog |\n| Remove | Always | Immediately removes (no confirmation) |\n\n## No Confirmation for Remove\nRemove doesn't require confirmation because:\n1. **Non-destructive** - Only removes from Maestro, not from disk\n2. **Easily reversible** - Can re-add the project immediately\n3. **Reduces friction** - One click to clean up\n\n## shadcn Components Needed\nThis task requires the DropdownMenu component from shadcn/ui:\n```bash\nnpx shadcn-ui@latest add dropdown-menu\n```\n\n## Integration with Page\n```typescript\n// In page.tsx\nconst [editingProject, setEditingProject] = useState\u003cProject | null\u003e(null);\nconst [relocatingProject, setRelocatingProject] = useState\u003cProject | null\u003e(null);\nconst deleteProject = useDeleteProject();\n\n// ...\n\n{projects?.map((project) =\u003e (\n  \u003cProjectCard\n    key={project.id}\n    project={project}\n    onEdit={() =\u003e setEditingProject(project)}\n    onRemove={() =\u003e deleteProject.mutate(project.id)}\n    onRelocate={project.status === \"missing\" ? () =\u003e setRelocatingProject(project) : undefined}\n  /\u003e\n))}\n\n{/* Edit dialog */}\n\u003cEditNameDialog \n  project={editingProject}\n  open={!!editingProject}\n  onOpenChange={(open) =\u003e !open \u0026\u0026 setEditingProject(null)}\n/\u003e\n\n{/* Relocate dialog */}\n\u003cRelocateDialog\n  project={relocatingProject}\n  open={!!relocatingProject}\n  onOpenChange={(open) =\u003e !open \u0026\u0026 setRelocatingProject(null)}\n/\u003e\n```\n\n## Acceptance Criteria\n- [ ] Three-dot menu icon on each project card\n- [ ] Menu opens on click without navigating to project\n- [ ] \"Edit Name\" option present for all projects\n- [ ] \"Remove\" option present for all projects\n- [ ] \"Relocate\" option present only for missing projects\n- [ ] Remove immediately deletes (no confirmation)\n- [ ] Menu closes after action\n- [ ] Touch-friendly (adequate tap target)\n\n## Dependencies\n- **Requires**: Task 7.1 (useDeleteProject hook)\n- **Requires**: shadcn DropdownMenu component\n- **Enables**: Tasks 5.2, 5.3, 5.4 (dialogs)\n\n## Files\n- `src/components/project-card/ProjectCard.tsx` (new)\n- `src/components/project-card/ProjectCardMenu.tsx` (new)\n- `src/components/ui/dropdown-menu.tsx` (shadcn - may need to add)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T07:55:03.54657-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:59:56.522041-06:00","dependencies":[{"issue_id":"maestro-slm.14","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.547029-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.15","title":"5.2 Implement edit project name functionality","description":"## Purpose\nImplement the edit project name dialog that allows users to change a project's display name. This is a simple modal with a text input and save/cancel buttons.\n\n## Visual Design\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  Edit Project Name                          [X] â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                                                 â”‚\nâ”‚  Display Name                                   â”‚\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\nâ”‚  â”‚ My Custom Name                          â”‚   â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\nâ”‚                                                 â”‚\nâ”‚  Leave empty to use folder name                 â”‚\nâ”‚                                                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                    [Cancel]  [Save]             â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## Props\n```typescript\ninterface EditNameDialogProps {\n  project: Project | null;\n  open: boolean;\n  onOpenChange: (open: boolean) =\u003e void;\n}\n```\n\n## Implementation\n```typescript\n// src/components/project-card/EditNameDialog.tsx\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useUpdateProject } from \"@/lib/hooks/useProjects\";\nimport { useState, useEffect } from \"react\";\n\nexport function EditNameDialog({ project, open, onOpenChange }: EditNameDialogProps) {\n  const [name, setName] = useState(\"\");\n  const [error, setError] = useState\u003cstring | null\u003e(null);\n  const updateProject = useUpdateProject();\n  \n  // Initialize with current name when dialog opens\n  useEffect(() =\u003e {\n    if (project \u0026\u0026 open) {\n      // Use custom name if set, otherwise show derived name as placeholder\n      setName(project.name || \"\");\n      setError(null);\n    }\n  }, [project, open]);\n  \n  const handleSave = async () =\u003e {\n    if (!project) return;\n    \n    setError(null);\n    try {\n      await updateProject.mutateAsync({\n        id: project.id,\n        name: name.trim() || null,  // Empty string â†’ null (use derived)\n      });\n      onOpenChange(false);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Failed to update name\");\n    }\n  };\n  \n  const derivedName = project?.path.split(\"/\").pop() || \"\";\n  \n  return (\n    \u003cDialog open={open} onOpenChange={onOpenChange}\u003e\n      \u003cDialogContent className=\"sm:max-w-md\"\u003e\n        \u003cDialogHeader\u003e\n          \u003cDialogTitle\u003eEdit Project Name\u003c/DialogTitle\u003e\n        \u003c/DialogHeader\u003e\n        \n        \u003cdiv className=\"space-y-4 py-4\"\u003e\n          \u003cdiv className=\"space-y-2\"\u003e\n            \u003cLabel htmlFor=\"name\"\u003eDisplay Name\u003c/Label\u003e\n            \u003cInput\n              id=\"name\"\n              value={name}\n              onChange={(e) =\u003e setName(e.target.value)}\n              placeholder={derivedName}\n            /\u003e\n            \u003cp className=\"text-xs text-muted-foreground\"\u003e\n              Leave empty to use folder name ({derivedName})\n            \u003c/p\u003e\n          \u003c/div\u003e\n          \n          {error \u0026\u0026 (\n            \u003cp className=\"text-sm text-destructive\"\u003e{error}\u003c/p\u003e\n          )}\n        \u003c/div\u003e\n        \n        \u003cDialogFooter\u003e\n          \u003cButton variant=\"outline\" onClick={() =\u003e onOpenChange(false)}\u003e\n            Cancel\n          \u003c/Button\u003e\n          \u003cButton \n            onClick={handleSave}\n            disabled={updateProject.isPending}\n          \u003e\n            {updateProject.isPending ? \"Saving...\" : \"Save\"}\n          \u003c/Button\u003e\n        \u003c/DialogFooter\u003e\n      \u003c/DialogContent\u003e\n    \u003c/Dialog\u003e\n  );\n}\n```\n\n## Behavior Details\n\n### Name Initialization\n- If project has custom name: Show it in input\n- If project uses derived name: Show empty input with derived name as placeholder\n\n### Saving Empty Name\n- Empty string or whitespace-only â†’ sets `name: null` in API\n- This reverts to derived name from path\n- Clear UX: \"Leave empty to use folder name\"\n\n### Validation\n- No client-side validation needed (any string is valid)\n- Server validates and returns error if needed\n- Show error message inline\n\n### Keyboard Support\n- Enter to save\n- Escape to cancel\n- Auto-focus input on open\n\n## shadcn Components Needed\n- Dialog (may already have from FolderBrowserModal)\n- Input\n- Label\n- Button\n\n## Acceptance Criteria\n- [ ] Dialog opens with current name pre-filled\n- [ ] Placeholder shows derived name\n- [ ] Can save custom name\n- [ ] Can clear name to revert to derived\n- [ ] Shows loading state while saving\n- [ ] Shows error messages inline\n- [ ] Closes on successful save\n- [ ] Cancel closes without saving\n- [ ] Enter key submits form\n\n## Dependencies\n- **Requires**: Task 7.1 (useUpdateProject hook)\n- **Requires**: Task 1.4 (PATCH endpoint)\n- **Used by**: Task 5.1 (ProjectCardMenu)\n\n## Files\n- `src/components/project-card/EditNameDialog.tsx` (new)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T07:55:03.603572-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T08:00:13.727045-06:00","dependencies":[{"issue_id":"maestro-slm.15","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.604037-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.16","title":"5.3 Implement missing project detection and warning UI","description":"## Purpose\nDetect and visually indicate when a project's path no longer exists on the filesystem. This helps users understand why a project might not be accessible and guides them to fix it.\n\n## Why Projects Go Missing\n- Project directory was moved or renamed\n- External drive was disconnected\n- Project was deleted from disk\n- Path was changed outside of Maestro\n\n## Visual Treatment\nMissing projects should be clearly distinguished from active ones:\n\n```\nActive project:\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  ğŸ“ my-project                                          [â‹®] â”‚\nâ”‚     ~/dev/my-project                              2 min ago â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\nMissing project:\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  ğŸ“ old-project                      âš ï¸ Missing         [â‹®] â”‚\nâ”‚     ~/dev/old-project                                       â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n  (dimmed/muted styling)\n```\n\n## Implementation\n\n### API Already Handles Detection\nThe GET /api/projects endpoint already validates each path and returns `status: \"active\" | \"missing\"`. No additional API work needed.\n\n### ProjectCard Updates\n```typescript\n// In ProjectCard.tsx\nconst isMissing = project.status === \"missing\";\n\nreturn (\n  \u003cdiv className={cn(\n    \"flex items-center gap-3 px-3 py-2.5 transition-colors\",\n    isMissing \n      ? \"opacity-60 bg-secondary/20\" \n      : \"hover:bg-secondary/50\"\n  )}\u003e\n    {/* Icon with warning indicator */}\n    \u003cdiv className=\"relative\"\u003e\n      \u003cdiv className={cn(\n        \"flex items-center justify-center w-8 h-8 rounded-md\",\n        isMissing ? \"bg-warning/10\" : \"bg-secondary\"\n      )}\u003e\n        \u003cFolder className={cn(\n          \"h-4 w-4\",\n          isMissing ? \"text-warning\" : \"text-muted-foreground\"\n        )} /\u003e\n      \u003c/div\u003e\n      {isMissing \u0026\u0026 (\n        \u003cAlertTriangle className=\"h-3 w-3 text-warning absolute -top-1 -right-1\" /\u003e\n      )}\n    \u003c/div\u003e\n    \n    \u003cdiv className=\"flex-1 min-w-0\"\u003e\n      \u003cdiv className=\"flex items-center gap-2\"\u003e\n        \u003cspan className={cn(\n          \"font-medium text-sm\",\n          isMissing \u0026\u0026 \"text-muted-foreground\"\n        )}\u003e\n          {project.displayName}\n        \u003c/span\u003e\n        {isMissing \u0026\u0026 (\n          \u003cspan className=\"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-xs font-medium bg-warning/10 text-warning\"\u003e\n            \u003cAlertTriangle className=\"h-3 w-3\" /\u003e\n            Missing\n          \u003c/span\u003e\n        )}\n      \u003c/div\u003e\n      \u003cp className=\"text-xs text-muted-foreground font-mono truncate\"\u003e\n        {project.displayPath}\n      \u003c/p\u003e\n    \u003c/div\u003e\n    \n    {/* ... rest of card ... */}\n  \u003c/div\u003e\n);\n```\n\n### Click Behavior\nMissing projects should NOT navigate to `/project/[id]` - there's nothing to show. Instead:\n- Click on card content: Does nothing or shows inline message\n- Click on menu: Opens menu with Relocate/Remove options\n\n```typescript\n// Prevent navigation for missing projects\n\u003cLink\n  href={isMissing ? \"#\" : `/project/${project.id}`}\n  onClick={isMissing ? (e) =\u003e e.preventDefault() : undefined}\n  className={cn(isMissing \u0026\u0026 \"cursor-default\")}\n\u003e\n```\n\n### Menu Options for Missing Projects\nThe menu should show \"Relocate\" as the primary action for missing projects:\n```typescript\n// In ProjectCardMenu\n{isMissing \u0026\u0026 (\n  \u003cDropdownMenuItem onClick={onRelocate} className=\"font-medium\"\u003e\n    \u003cFolderSearch className=\"h-4 w-4 mr-2\" /\u003e\n    Relocate\n  \u003c/DropdownMenuItem\u003e\n)}\n```\n\n## Alternative Approaches Considered\n\n### Inline Relocate Button\nCould show a \"Relocate\" button directly on the card instead of in the menu. Decided against because:\n- Clutters the UI\n- Inconsistent with active project cards\n- Menu works well for infrequent action\n\n### Auto-hide Missing Projects\nCould hide missing projects by default. Decided against because:\n- User might not realize project is gone\n- No way to know something needs fixing\n- Better to show problem and offer fix\n\n### Toast on Detection\nCould show toast when missing project detected. Decided against because:\n- Could be annoying on every page load\n- Visual indicator is sufficient\n- User can fix when they want to\n\n## Acceptance Criteria\n- [ ] Missing projects have dimmed/muted styling\n- [ ] Warning icon or badge indicates \"Missing\" status\n- [ ] Click doesn't navigate to project page\n- [ ] Menu shows \"Relocate\" option prominently\n- [ ] Menu still shows \"Remove\" option\n- [ ] Clear visual distinction from active projects\n\n## Dependencies\n- **Requires**: Task 1.2 (API returns status field)\n- **Part of**: Task 5.1 (ProjectCard component)\n- **Enables**: Task 5.4 (Relocate functionality)\n\n## Files\n- `src/components/project-card/ProjectCard.tsx` (update)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T07:55:03.662499-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T08:00:34.311203-06:00","dependencies":[{"issue_id":"maestro-slm.16","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.662971-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.17","title":"5.4 Implement relocate project functionality for missing projects","description":"## Purpose\nAllow users to \"relocate\" a missing project by selecting a new path via the folder browser. This preserves the project's ID and any associated data while updating where Maestro looks for it.\n\n## Use Case\n1. User moved `~/dev/my-project` to `~/dev/projects/my-project`\n2. Maestro shows project as \"Missing\"\n3. User clicks Relocate\n4. Folder browser opens, navigated to `~/dev` (parent of old path, or default if parent gone)\n5. User navigates to `~/dev/projects/my-project`\n6. User clicks \"Update Location\"\n7. Project is now tracked at new path, same ID preserved\n\n## Why Preserve ID?\nThe project ID is a UUID used in routing (`/project/[id]`). By keeping the same ID:\n- Bookmarks to the project still work\n- Any future features using project ID (settings, history) stay linked\n- Cleaner than delete + re-add\n\n## Visual Design\nThe relocate dialog is similar to the add project modal, but:\n- Different title: \"Relocate Project\" instead of \"Select Project Folder\"\n- Shows the old path for context\n- Button says \"Update Location\" instead of \"Add Project\"\n- No custom name input (keep existing name)\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  Relocate Project                           [X] â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  Current path (missing):                        â”‚\nâ”‚  ~/dev/old-location/my-project                  â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  ~ / dev / projects / my-project            [â†‘] â”‚  â† Breadcrumbs\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  ğŸ“ api-gateway              git                â”‚\nâ”‚  ğŸ“ frontend                 git                â”‚\nâ”‚                                                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                [Cancel]  [Update Location]      â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## Implementation\n```typescript\n// src/components/project-card/RelocateDialog.tsx\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { FolderBrowser } from \"@/components/folder-browser/FolderBrowser\";\nimport { Breadcrumbs } from \"@/components/folder-browser/Breadcrumbs\";\nimport { useUpdateProject } from \"@/lib/hooks/useProjects\";\nimport { useFilesystem } from \"@/lib/hooks/useFilesystem\";\nimport { AlertTriangle } from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport path from \"path\";\n\ninterface RelocateDialogProps {\n  project: Project | null;\n  open: boolean;\n  onOpenChange: (open: boolean) =\u003e void;\n}\n\nexport function RelocateDialog({ project, open, onOpenChange }: RelocateDialogProps) {\n  const [currentPath, setCurrentPath] = useState\u003cstring | undefined\u003e();\n  const [error, setError] = useState\u003cstring | null\u003e(null);\n  \n  const updateProject = useUpdateProject();\n  const { data: filesystem, isLoading } = useFilesystem(currentPath);\n  \n  // Set initial path when dialog opens\n  useEffect(() =\u003e {\n    if (project \u0026\u0026 open) {\n      // Try to start at parent of old path\n      // API will fall back to ~/dev or ~ if parent doesn't exist\n      const parentPath = project.path.split(\"/\").slice(0, -1).join(\"/\");\n      setCurrentPath(parentPath || undefined);\n      setError(null);\n    }\n  }, [project, open]);\n  \n  const handleRelocate = async () =\u003e {\n    if (!project || !filesystem?.currentPath) return;\n    \n    setError(null);\n    try {\n      await updateProject.mutateAsync({\n        id: project.id,\n        path: filesystem.currentPath,\n      });\n      onOpenChange(false);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Failed to relocate project\");\n    }\n  };\n  \n  return (\n    \u003cDialog open={open} onOpenChange={onOpenChange}\u003e\n      \u003cDialogContent className=\"max-w-lg max-h-[80vh] flex flex-col p-0\"\u003e\n        \u003cDialogHeader className=\"px-4 py-3 border-b\"\u003e\n          \u003cDialogTitle\u003eRelocate Project\u003c/DialogTitle\u003e\n        \u003c/DialogHeader\u003e\n        \n        {/* Old path context */}\n        {project \u0026\u0026 (\n          \u003cdiv className=\"px-4 py-3 bg-secondary/30 border-b\"\u003e\n            \u003cdiv className=\"flex items-center gap-2 text-sm text-muted-foreground\"\u003e\n              \u003cAlertTriangle className=\"h-4 w-4 text-warning\" /\u003e\n              \u003cspan\u003eCurrent path (missing):\u003c/span\u003e\n            \u003c/div\u003e\n            \u003cp className=\"text-sm font-mono mt-1\"\u003e{project.displayPath}\u003c/p\u003e\n          \u003c/div\u003e\n        )}\n        \n        {/* Breadcrumbs */}\n        {filesystem \u0026\u0026 (\n          \u003cBreadcrumbs\n            currentPath={filesystem.currentPath}\n            displayPath={filesystem.displayPath}\n            onNavigate={setCurrentPath}\n            parent={filesystem.parent}\n            canGoUp={filesystem.canGoUp}\n          /\u003e\n        )}\n        \n        {/* Directory List */}\n        \u003cdiv className=\"flex-1 overflow-y-auto min-h-[200px]\"\u003e\n          \u003cFolderBrowser\n            currentPath={currentPath}\n            onNavigate={setCurrentPath}\n          /\u003e\n        \u003c/div\u003e\n        \n        {/* Error */}\n        {error \u0026\u0026 (\n          \u003cdiv className=\"px-4 py-2 text-sm text-destructive border-t\"\u003e\n            {error}\n          \u003c/div\u003e\n        )}\n        \n        {/* Actions */}\n        \u003cdiv className=\"flex justify-end gap-2 px-4 py-3 border-t\"\u003e\n          \u003cButton variant=\"outline\" onClick={() =\u003e onOpenChange(false)}\u003e\n            Cancel\n          \u003c/Button\u003e\n          \u003cButton \n            onClick={handleRelocate}\n            disabled={!filesystem?.currentPath || updateProject.isPending}\n          \u003e\n            {updateProject.isPending ? \"Updating...\" : \"Update Location\"}\n          \u003c/Button\u003e\n        \u003c/div\u003e\n      \u003c/DialogContent\u003e\n    \u003c/Dialog\u003e\n  );\n}\n```\n\n## Error Handling\nThe PATCH endpoint handles validation:\n- **404**: New path doesn't exist â†’ show error, stay in dialog\n- **400**: New path is not a directory â†’ show error\n- **403**: New path outside home â†’ show error\n- **409**: New path already tracked by another project â†’ show error\n\nShow all errors inline, keep dialog open for retry.\n\n## Reusability Note\nThis dialog is very similar to FolderBrowserModal. Consider:\n1. Keep separate (clearer code, slightly different UX)\n2. Create shared base component (DRYer, more complex)\n\nFor v1, keeping separate is fine. Can refactor later if needed.\n\n## Acceptance Criteria\n- [ ] Opens from \"Relocate\" menu item on missing projects\n- [ ] Shows old path for context\n- [ ] Starts navigation at parent of old path (if exists)\n- [ ] Can navigate filesystem to find new location\n- [ ] \"Update Location\" calls PATCH API with new path\n- [ ] Shows loading state during update\n- [ ] Shows error messages inline\n- [ ] Closes on successful update\n- [ ] Project list refreshes with new path\n- [ ] Project status changes to \"active\" if path valid\n\n## Dependencies\n- **Requires**: Task 7.1 (useUpdateProject hook)\n- **Requires**: Task 1.4 (PATCH /api/projects/:id endpoint)\n- **Requires**: Task 3.1, 3.2 (FolderBrowser, Breadcrumbs components)\n- **Used by**: Task 5.1, 5.3 (ProjectCard menu)\n\n## Files\n- `src/components/project-card/RelocateDialog.tsx` (new)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T07:55:03.719655-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T08:01:02.680011-06:00","dependencies":[{"issue_id":"maestro-slm.17","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.720096-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.18","title":"6.1 Update sidebar to fetch projects from API","description":"## Purpose\nUpdate the sidebar to fetch projects from the API instead of using mock data. The sidebar shows all projects in the left navigation, allowing users to switch between projects.\n\n## Current State\n```typescript\n// In sidebar.tsx\nimport { mockProjects } from \"@/lib/data/mock\";\n// ...\n{mockProjects.map((project) =\u003e (\n```\n\n## Target State\n```typescript\nimport { useProjects } from \"@/lib/hooks/useProjects\";\n// ...\nconst { data: projects } = useProjects();\n// ...\n{projects?.map((project) =\u003e (\n```\n\n## Changes Required\n\n### 1. Import and use hook\n```typescript\nimport { useProjects } from \"@/lib/hooks/useProjects\";\n\nexport function Sidebar() {\n  const { data: projects, isLoading } = useProjects();\n  // ...\n}\n```\n\n### 2. Update project mapping\n```typescript\n{projects?.map((project) =\u003e {\n  const isCurrentProject = project.id === currentProjectId;\n  const isMissing = project.status === \"missing\";\n\n  return (\n    \u003cTreeItem\n      key={project.id}\n      icon={\n        isCurrentProject ? (\n          \u003cFolderOpen className=\"h-4 w-4 text-primary\" /\u003e\n        ) : isMissing ? (\n          \u003cFolder className=\"h-4 w-4 text-warning\" /\u003e\n        ) : (\n          \u003cFolder className=\"h-4 w-4\" /\u003e\n        )\n      }\n      label={project.displayName}\n      defaultOpen={isCurrentProject}\n      statusIndicator={isMissing ? \"warning\" : hasActiveSwarm ? \"active\" : undefined}\n    \u003e\n      {/* ... epics and sessions for current project ... */}\n    \u003c/TreeItem\u003e\n  );\n})}\n```\n\n### 3. Handle loading state\nFor sidebar, a subtle loading state is appropriate:\n```typescript\n{isLoading ? (\n  // Show minimal skeleton or loading indicator\n  \u003cdiv className=\"px-4 py-2 text-xs text-muted-foreground\"\u003e\n    Loading projects...\n  \u003c/div\u003e\n) : projects?.length ? (\n  // Show projects\n) : (\n  // Empty state - maybe just show nothing, or prompt to add\n  \u003cdiv className=\"px-4 py-2 text-xs text-muted-foreground\"\u003e\n    No projects\n  \u003c/div\u003e\n)}\n```\n\n### 4. Show missing projects with warning\nMissing projects should be visible in sidebar with a visual indicator so users know to fix them:\n```typescript\nstatusIndicator={isMissing ? \"warning\" : /* ... */}\n```\n\nThe TreeItem component already supports a \"warning\" status indicator.\n\n## Missing Projects in Sidebar\nDecision: **Show missing projects** with warning indicator.\n\nRationale:\n- User should be aware of the problem\n- Can click and see \"Missing\" state, then fix\n- Hiding would make the problem invisible\n\n## Activity Data\nThe sidebar currently shows:\n- Active swarms count (from mock)\n- In progress count (from mock)\n\nUntil OpenCode integration is complete, these will show 0 or be hidden:\n```typescript\nconst hasActiveSwarm = false; // TODO: Get from OpenCode\n```\n\n## Epics and Sessions\nThe sidebar shows epics and sessions for the current project. These still use mock data for now (separate feature work). This task only updates the project list portion.\n\n## Acceptance Criteria\n- [ ] Fetches projects from API using useProjects hook\n- [ ] Renders project tree items with displayName\n- [ ] Current project is highlighted and expanded\n- [ ] Missing projects show warning indicator\n- [ ] Loading state while fetching\n- [ ] Empty state when no projects\n- [ ] Remove mockProjects import\n\n## Dependencies\n- **Requires**: Task 7.1 (useProjects hook)\n- **Requires**: Task 7.2 (React Query provider)\n- **Requires**: Task 1.2 (GET /api/projects endpoint)\n\n## Files\n- `src/components/ui/sidebar.tsx` (modify)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T07:55:03.779159-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T08:01:19.101614-06:00","dependencies":[{"issue_id":"maestro-slm.18","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.77965-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.19","title":"6.2 Wire sidebar '+' button to open folder browser modal","description":"## Purpose\nWire the \"+\" button in the sidebar's Projects header to open the folder browser modal. This provides a consistent entry point for adding projects from anywhere in the app.\n\n## Current State\n```typescript\n// In sidebar.tsx\n\u003cdiv className=\"flex items-center justify-between px-2 py-1\"\u003e\n  \u003cspan className=\"text-xs font-medium text-muted-foreground uppercase tracking-wider\"\u003e\n    Projects\n  \u003c/span\u003e\n  \u003cbutton className=\"h-5 w-5 rounded hover:bg-secondary flex items-center justify-center\"\u003e\n    \u003cPlus className=\"h-3 w-3 text-muted-foreground\" /\u003e\n  \u003c/button\u003e\n\u003c/div\u003e\n```\n\nThe button exists but does nothing.\n\n## Challenge: Modal State Across Components\nThe FolderBrowserModal is rendered at the page level (in page.tsx), but the sidebar is a separate component. We need a way to open the modal from the sidebar.\n\n## Solutions\n\n### Option 1: Context (Recommended)\nCreate a context to manage the folder browser modal state:\n```typescript\n// src/contexts/FolderBrowserContext.tsx\ninterface FolderBrowserContextType {\n  openFolderBrowser: () =\u003e void;\n}\n\nconst FolderBrowserContext = createContext\u003cFolderBrowserContextType | null\u003e(null);\n\nexport function useFolderBrowser() {\n  const context = useContext(FolderBrowserContext);\n  if (!context) throw new Error(\"useFolderBrowser must be used within FolderBrowserProvider\");\n  return context;\n}\n\n// In layout or page\n\u003cFolderBrowserContext.Provider value={{ openFolderBrowser: () =\u003e setModalOpen(true) }}\u003e\n  \u003cSidebar /\u003e\n  {/* ... */}\n  \u003cFolderBrowserModal open={modalOpen} onOpenChange={setModalOpen} /\u003e\n\u003c/FolderBrowserContext.Provider\u003e\n```\n\n### Option 2: Callback Prop\nPass a callback through component hierarchy:\n```typescript\n// In layout\n\u003cSidebar onAddProject={() =\u003e setModalOpen(true)} /\u003e\n```\n\nThis works but requires prop drilling through layout â†’ sidebar.\n\n### Option 3: Portal Modal in Sidebar\nRender the modal from within the sidebar:\n```typescript\n// In sidebar.tsx\nconst [modalOpen, setModalOpen] = useState(false);\n\nreturn (\n  \u003c\u003e\n    {/* sidebar content */}\n    \u003cFolderBrowserModal open={modalOpen} onOpenChange={setModalOpen} /\u003e\n  \u003c/\u003e\n);\n```\n\nThis is simplest but means multiple modal instances if main page also has one.\n\n## Recommended Approach: Option 3 (Simple)\nFor v1, render the modal directly in the sidebar. Multiple modal instances aren't a problem since only one is open at a time, and they share the same React Query cache for instant updates.\n\n```typescript\n// src/components/ui/sidebar.tsx\nimport { FolderBrowserModal } from \"@/components/folder-browser/FolderBrowserModal\";\nimport { useState } from \"react\";\n\nexport function Sidebar() {\n  const [folderBrowserOpen, setFolderBrowserOpen] = useState(false);\n  const { data: projects } = useProjects();\n  \n  return (\n    \u003cdiv className=\"w-64 h-screen flex flex-col border-r border-border bg-card\"\u003e\n      {/* ... header, search ... */}\n      \n      \u003cnav className=\"flex-1 overflow-y-auto px-2 py-2\"\u003e\n        {/* Projects Section */}\n        \u003cdiv className=\"mb-2\"\u003e\n          \u003cdiv className=\"flex items-center justify-between px-2 py-1\"\u003e\n            \u003cspan className=\"text-xs font-medium text-muted-foreground uppercase tracking-wider\"\u003e\n              Projects\n            \u003c/span\u003e\n            \u003cbutton \n              onClick={() =\u003e setFolderBrowserOpen(true)}\n              className=\"h-5 w-5 rounded hover:bg-secondary flex items-center justify-center\"\n            \u003e\n              \u003cPlus className=\"h-3 w-3 text-muted-foreground\" /\u003e\n            \u003c/button\u003e\n          \u003c/div\u003e\n        \u003c/div\u003e\n        \n        {/* ... project tree ... */}\n      \u003c/nav\u003e\n      \n      {/* ... bottom actions ... */}\n      \n      {/* Folder Browser Modal */}\n      \u003cFolderBrowserModal \n        open={folderBrowserOpen} \n        onOpenChange={setFolderBrowserOpen}\n      /\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n## Accessibility\nThe \"+\" button should be properly labeled:\n```typescript\n\u003cbutton \n  onClick={() =\u003e setFolderBrowserOpen(true)}\n  className=\"...\"\n  aria-label=\"Add project\"\n\u003e\n  \u003cPlus className=\"h-3 w-3 text-muted-foreground\" /\u003e\n\u003c/button\u003e\n```\n\n## Success Behavior\nAfter adding a project:\n1. Modal closes\n2. useProjects hook refetches (React Query invalidation)\n3. New project appears in sidebar immediately\n4. No need to refresh page\n\n## Acceptance Criteria\n- [ ] \"+\" button in sidebar opens folder browser modal\n- [ ] Can add project from sidebar\n- [ ] Project list updates after add\n- [ ] Modal closes on success\n- [ ] Button has proper aria-label\n- [ ] Works consistently with main page add button\n\n## Dependencies\n- **Requires**: Task 3.3 (FolderBrowserModal)\n- **Requires**: Task 6.1 (Sidebar fetches from API)\n\n## Files\n- `src/components/ui/sidebar.tsx` (update)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-30T07:55:03.837573-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T08:01:37.503876-06:00","dependencies":[{"issue_id":"maestro-slm.19","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.838036-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.2","title":"1.2 Implement GET /api/projects endpoint","description":"## Purpose\nImplement the `GET /api/projects` endpoint that returns all saved projects with computed fields and validation status.\n\n## Why This Endpoint?\nThis is the primary data source for the project list UI. It must:\n1. Return all projects from config\n2. Compute display-friendly fields (displayPath, displayName)\n3. Validate each project's path still exists\n4. Sort by most recently added\n\n## Response Schema\n```typescript\ninterface ProjectsResponse {\n  projects: Project[];\n}\n\ninterface Project {\n  id: string;\n  path: string;              // Absolute: /Users/erik/dev/project\n  displayPath: string;       // Friendly: ~/dev/project\n  name: string | null;       // Custom name or null\n  displayName: string;       // name ?? derived from path\n  addedAt: string;           // ISO 8601\n  status: \"active\" | \"missing\";\n}\n```\n\n## Implementation\n```typescript\n// src/app/api/projects/route.ts\nimport { NextResponse } from \"next/server\";\nimport { configService } from \"@/lib/services/config\";\nimport fs from \"fs/promises\";\n\nexport async function GET() {\n  try {\n    const projects = await configService.getProjects();\n    \n    const enrichedProjects = await Promise.all(\n      projects.map(async (p) =\u003e {\n        // Check if path exists\n        let status: \"active\" | \"missing\" = \"active\";\n        try {\n          await fs.access(p.path);\n        } catch {\n          status = \"missing\";\n        }\n        \n        return {\n          id: p.id,\n          path: p.path,\n          displayPath: configService.toDisplayPath(p.path),\n          name: p.name,\n          displayName: p.name ?? configService.deriveDisplayName(p.path),\n          addedAt: p.addedAt,\n          status,\n        };\n      })\n    );\n    \n    // Sort by addedAt descending (most recent first)\n    enrichedProjects.sort((a, b) =\u003e \n      new Date(b.addedAt).getTime() - new Date(a.addedAt).getTime()\n    );\n    \n    return NextResponse.json({ projects: enrichedProjects });\n  } catch (error) {\n    console.error(\"Failed to fetch projects:\", error);\n    return NextResponse.json(\n      { error: \"Failed to fetch projects\" },\n      { status: 500 }\n    );\n  }\n}\n```\n\n## Performance Note\nPath validation (`fs.access`) is done for each project on every request. For typical use cases (\u003c 20 projects), this is fine. If it becomes slow, we could:\n- Cache validation results briefly\n- Validate asynchronously and update status in background\n- Only validate on explicit refresh\n\nFor v1, keep it simple - validate on every request.\n\n## Acceptance Criteria\n- [ ] Returns all projects from config\n- [ ] Computes displayPath correctly (~ notation)\n- [ ] Computes displayName correctly (custom or derived)\n- [ ] Detects missing projects (path doesn't exist)\n- [ ] Sorts by addedAt descending\n- [ ] Returns empty array when no projects (not error)\n- [ ] Returns 500 on unexpected errors\n\n## Dependencies\n- **Requires**: Task 1.1 (Config service)\n\n## Files\n- `src/app/api/projects/route.ts` (new)","status":"open","priority":0,"issue_type":"task","created_at":"2025-12-30T07:55:02.851831-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:55:46.993424-06:00","dependencies":[{"issue_id":"maestro-slm.2","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:02.852315-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.20","title":"7.1 Create shared React Query hooks for projects API","description":"## Purpose\nCreate shared React Query hooks that encapsulate all API interactions for projects and filesystem browsing. These hooks provide a consistent, type-safe interface for components to fetch and mutate data.\n\n## Why Custom Hooks?\n1. **DRY** - Don't repeat query keys, fetch logic, error handling\n2. **Type safety** - Return types match API response schemas\n3. **Optimistic updates** - Centralized cache invalidation logic\n4. **Testing** - Easy to mock in component tests\n\n## Hook API Design\n\n### useProjects\n```typescript\n// src/lib/hooks/useProjects.ts\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\n\ninterface Project {\n  id: string;\n  path: string;\n  displayPath: string;\n  name: string | null;\n  displayName: string;\n  addedAt: string;\n  status: \"active\" | \"missing\";\n}\n\nexport function useProjects() {\n  return useQuery({\n    queryKey: [\"projects\"],\n    queryFn: async (): Promise\u003cProject[]\u003e =\u003e {\n      const res = await fetch(\"/api/projects\");\n      if (!res.ok) throw new Error(\"Failed to fetch projects\");\n      const data = await res.json();\n      return data.projects;\n    },\n  });\n}\n\nexport function useProject(id: string) {\n  const { data: projects } = useProjects();\n  return projects?.find(p =\u003e p.id === id);\n}\n```\n\n### useAddProject\n```typescript\nexport function useAddProject() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: async (input: { path: string; name?: string }) =\u003e {\n      const res = await fetch(\"/api/projects\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(input),\n      });\n      if (!res.ok) {\n        const error = await res.json();\n        throw new Error(error.error || \"Failed to add project\");\n      }\n      return res.json();\n    },\n    onSuccess: () =\u003e {\n      queryClient.invalidateQueries({ queryKey: [\"projects\"] });\n    },\n  });\n}\n```\n\n### useUpdateProject\n```typescript\nexport function useUpdateProject() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: async ({ id, ...updates }: { id: string; name?: string | null; path?: string }) =\u003e {\n      const res = await fetch(`/api/projects/${id}`, {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(updates),\n      });\n      if (!res.ok) {\n        const error = await res.json();\n        throw new Error(error.error || \"Failed to update project\");\n      }\n      return res.json();\n    },\n    onSuccess: () =\u003e {\n      queryClient.invalidateQueries({ queryKey: [\"projects\"] });\n    },\n  });\n}\n```\n\n### useDeleteProject\n```typescript\nexport function useDeleteProject() {\n  const queryClient = useQueryClient();\n  \n  return useMutation({\n    mutationFn: async (id: string) =\u003e {\n      const res = await fetch(`/api/projects/${id}`, {\n        method: \"DELETE\",\n      });\n      if (!res.ok \u0026\u0026 res.status !== 204) {\n        throw new Error(\"Failed to delete project\");\n      }\n    },\n    onSuccess: () =\u003e {\n      queryClient.invalidateQueries({ queryKey: [\"projects\"] });\n    },\n  });\n}\n```\n\n### useFilesystem\n```typescript\n// src/lib/hooks/useFilesystem.ts\ninterface Directory {\n  name: string;\n  path: string;\n  isGitRepo: boolean;\n}\n\ninterface BrowseResult {\n  currentPath: string;\n  displayPath: string;\n  parent: string | null;\n  canGoUp: boolean;\n  directories: Directory[];\n}\n\nexport function useFilesystem(path?: string) {\n  return useQuery({\n    queryKey: [\"filesystem\", path],\n    queryFn: async (): Promise\u003cBrowseResult\u003e =\u003e {\n      const url = path \n        ? `/api/filesystem/browse?path=${encodeURIComponent(path)}`\n        : \"/api/filesystem/browse\";\n      const res = await fetch(url);\n      if (!res.ok) {\n        const error = await res.json();\n        throw new Error(error.error || \"Failed to browse directory\");\n      }\n      return res.json();\n    },\n    // Keep previous data while navigating to avoid flash\n    placeholderData: (previousData) =\u003e previousData,\n  });\n}\n```\n\n## Error Handling Pattern\nAll hooks throw errors that can be caught by error boundaries or handled by the component:\n```typescript\nconst { data, error, isLoading } = useProjects();\n\nif (error) {\n  return \u003cErrorState message={error.message} onRetry={() =\u003e refetch()} /\u003e;\n}\n```\n\n## Cache Invalidation Strategy\n- After add/update/delete, invalidate the entire projects list\n- For filesystem browsing, each path is cached independently\n- Use `placeholderData` to keep showing old data while new data loads\n\n## Type Exports\nExport all types so components have full type safety:\n```typescript\nexport type { Project, Directory, BrowseResult };\n```\n\n## Acceptance Criteria\n- [ ] useProjects fetches and returns project list\n- [ ] useProject(id) returns single project from cache\n- [ ] useAddProject mutation works with cache invalidation\n- [ ] useUpdateProject mutation works with cache invalidation\n- [ ] useDeleteProject mutation works with cache invalidation\n- [ ] useFilesystem fetches directory contents\n- [ ] All hooks have proper TypeScript types\n- [ ] Error messages propagate from API responses\n\n## Dependencies\n- **Requires**: Task 7.2 (React Query provider)\n- **Requires**: Tasks 1.2, 1.3, 2.1 (API endpoints must exist)\n\n## Files\n- `src/lib/hooks/useProjects.ts` (new)\n- `src/lib/hooks/useFilesystem.ts` (new)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-30T07:55:03.894727-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:57:14.528958-06:00","dependencies":[{"issue_id":"maestro-slm.20","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.895215-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.21","title":"7.2 Set up React Query provider","description":"## Purpose\nSet up React Query (TanStack Query) as the data fetching and caching layer for all API interactions. This is a foundational task that must be completed before any UI components can consume API data.\n\n## Why React Query?\n1. **Automatic caching** - Projects list is fetched once and cached; subsequent navigations are instant\n2. **Background refetching** - Stale data is refreshed automatically when window regains focus\n3. **Optimistic updates** - Edit/delete operations feel instant while we sync with server\n4. **Loading/error states** - Standardized handling across all API calls\n5. **Request deduplication** - Multiple components requesting same data = one network call\n\n## Implementation Details\n\n### Install dependencies\n```bash\nbun add @tanstack/react-query\n```\n\n### Create providers.tsx\n```typescript\n// src/app/providers.tsx\n\"use client\";\nimport { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport { useState } from \"react\";\n\nexport function Providers({ children }: { children: React.ReactNode }) {\n  const [queryClient] = useState(() =\u003e new QueryClient({\n    defaultOptions: {\n      queries: {\n        staleTime: 60 * 1000, // 1 minute before refetch\n        retry: 1,\n      },\n    },\n  }));\n  \n  return (\n    \u003cQueryClientProvider client={queryClient}\u003e\n      {children}\n    \u003c/QueryClientProvider\u003e\n  );\n}\n```\n\n### Update layout.tsx\nWrap the app with Providers in the root layout.\n\n## Considerations\n- Use `useState` for QueryClient to avoid recreating on each render (App Router requirement)\n- Set reasonable `staleTime` - projects don't change often, but we want fresh data on focus\n- Single retry is enough - if server is down, failing fast is better than hanging\n\n## Acceptance Criteria\n- [ ] @tanstack/react-query installed\n- [ ] Providers component created with QueryClientProvider\n- [ ] Root layout wraps children with Providers\n- [ ] Can use `useQuery` in any client component\n\n## Dependencies\nNone - this is a foundational task.\n\n## Files\n- `src/app/providers.tsx` (new)\n- `src/app/layout.tsx` (modify)\n- `package.json` (dependency added)","status":"open","priority":0,"issue_type":"task","created_at":"2025-12-30T07:55:03.954086-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:55:19.407706-06:00","dependencies":[{"issue_id":"maestro-slm.21","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.954563-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.3","title":"1.3 Implement POST /api/projects endpoint","description":"## Purpose\nImplement the `POST /api/projects` endpoint for adding new projects to Maestro.\n\n## Why Validation Matters\nThis endpoint is the gatekeeper for project integrity. It must validate:\n1. Path is provided and non-empty\n2. Path exists on the filesystem\n3. Path is a directory (not a file)\n4. Path is within user's home directory (security)\n5. Path isn't already tracked (no duplicates)\n\n## Request Schema\n```typescript\ninterface AddProjectRequest {\n  path: string;       // Required: absolute path\n  name?: string;      // Optional: custom display name\n}\n```\n\n## Response Schema\nOn success, returns the created project (same shape as GET response item):\n```typescript\ninterface Project {\n  id: string;\n  path: string;\n  displayPath: string;\n  name: string | null;\n  displayName: string;\n  addedAt: string;\n  status: \"active\";\n}\n```\n\n## Error Responses\n| Status | Condition | Response |\n|--------|-----------|----------|\n| 400 | Missing or empty path | `{ error: \"Path is required\" }` |\n| 400 | Path is not a directory | `{ error: \"Path is not a directory\" }` |\n| 403 | Path outside home directory | `{ error: \"Path must be within home directory\" }` |\n| 404 | Path does not exist | `{ error: \"Path does not exist\" }` |\n| 409 | Duplicate path | `{ error: \"Project already exists\" }` |\n\n## Implementation\n```typescript\nexport async function POST(request: Request) {\n  try {\n    const body = await request.json();\n    const { path: inputPath, name } = body;\n    \n    // Validate path provided\n    if (!inputPath || typeof inputPath !== \"string\" || !inputPath.trim()) {\n      return NextResponse.json(\n        { error: \"Path is required\" },\n        { status: 400 }\n      );\n    }\n    \n    const absolutePath = configService.toAbsolutePath(inputPath.trim());\n    \n    // Security: must be within home\n    if (!configService.isWithinHome(absolutePath)) {\n      return NextResponse.json(\n        { error: \"Path must be within home directory\" },\n        { status: 403 }\n      );\n    }\n    \n    // Check path exists\n    try {\n      await fs.access(absolutePath);\n    } catch {\n      return NextResponse.json(\n        { error: \"Path does not exist\" },\n        { status: 404 }\n      );\n    }\n    \n    // Check it's a directory\n    const stat = await fs.stat(absolutePath);\n    if (!stat.isDirectory()) {\n      return NextResponse.json(\n        { error: \"Path is not a directory\" },\n        { status: 400 }\n      );\n    }\n    \n    // Check for duplicates\n    const existing = await configService.getProjects();\n    if (existing.some(p =\u003e p.path === absolutePath)) {\n      return NextResponse.json(\n        { error: \"Project already exists\" },\n        { status: 409 }\n      );\n    }\n    \n    // Add project\n    const project = await configService.addProject(\n      absolutePath,\n      name?.trim() || undefined\n    );\n    \n    return NextResponse.json({\n      id: project.id,\n      path: project.path,\n      displayPath: configService.toDisplayPath(project.path),\n      name: project.name,\n      displayName: project.name ?? configService.deriveDisplayName(project.path),\n      addedAt: project.addedAt,\n      status: \"active\",\n    }, { status: 201 });\n    \n  } catch (error) {\n    console.error(\"Failed to add project:\", error);\n    return NextResponse.json(\n      { error: \"Failed to add project\" },\n      { status: 500 }\n    );\n  }\n}\n```\n\n## Edge Cases\n- **Path with trailing slash**: Normalize before storing\n- **Path with ~**: Expand to absolute before validation/storage\n- **Symlink path**: Follow symlink, check resolved path is within home\n- **Empty name string**: Treat as null (use derived name)\n- **Whitespace-only name**: Treat as null\n\n## Acceptance Criteria\n- [ ] Validates all required fields\n- [ ] Returns 400 for missing/invalid path\n- [ ] Returns 403 for paths outside home directory\n- [ ] Returns 404 for non-existent paths\n- [ ] Returns 400 for file paths (not directories)\n- [ ] Returns 409 for duplicate paths\n- [ ] Returns 201 with created project on success\n- [ ] Generated UUID is used in response\n- [ ] Timestamp is set correctly\n\n## Dependencies\n- **Requires**: Task 1.1 (Config service)\n- **Can parallel with**: Task 1.2 (GET endpoint)\n\n## Files\n- `src/app/api/projects/route.ts` (add POST handler)","status":"open","priority":0,"issue_type":"task","created_at":"2025-12-30T07:55:02.92336-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:56:01.099428-06:00","dependencies":[{"issue_id":"maestro-slm.3","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:02.9238-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.4","title":"1.4 Implement PATCH /api/projects/[id] endpoint","description":"## Purpose\nImplement the `PATCH /api/projects/[id]` endpoint for updating project name or relocating its path.\n\n## Use Cases\n1. **Rename**: User wants to change the display name\n2. **Revert to derived name**: User sets name to null\n3. **Relocate**: Project was moved on disk, user points Maestro to new location\n\n## Request Schema\n```typescript\ninterface UpdateProjectRequest {\n  name?: string | null;  // New display name, null to use derived\n  path?: string;         // New path (for relocation)\n}\n```\n\nAt least one field must be provided.\n\n## Response Schema\nReturns the updated project (same shape as GET response item).\n\n## Error Responses\n| Status | Condition | Response |\n|--------|-----------|----------|\n| 400 | No fields to update | `{ error: \"No fields to update\" }` |\n| 400 | Invalid path (if provided) | `{ error: \"Path is not a directory\" }` |\n| 403 | Path outside home (if provided) | `{ error: \"Path must be within home directory\" }` |\n| 404 | Project ID not found | `{ error: \"Project not found\" }` |\n| 404 | New path doesn't exist | `{ error: \"Path does not exist\" }` |\n| 409 | New path already tracked | `{ error: \"A project with this path already exists\" }` |\n\n## Implementation\n```typescript\n// src/app/api/projects/[id]/route.ts\nimport { NextResponse } from \"next/server\";\nimport { configService } from \"@/lib/services/config\";\nimport fs from \"fs/promises\";\n\nexport async function PATCH(\n  request: Request,\n  { params }: { params: { id: string } }\n) {\n  try {\n    const { id } = params;\n    const body = await request.json();\n    const { name, path: newPath } = body;\n    \n    // Check project exists\n    const project = await configService.getProject(id);\n    if (!project) {\n      return NextResponse.json(\n        { error: \"Project not found\" },\n        { status: 404 }\n      );\n    }\n    \n    // Build updates\n    const updates: Partial\u003cProjectConfig\u003e = {};\n    \n    // Handle name update\n    if (\"name\" in body) {\n      // Explicit null or empty string â†’ null (use derived)\n      updates.name = name?.trim() || null;\n    }\n    \n    // Handle path update (relocation)\n    if (newPath) {\n      const absolutePath = configService.toAbsolutePath(newPath.trim());\n      \n      if (!configService.isWithinHome(absolutePath)) {\n        return NextResponse.json(\n          { error: \"Path must be within home directory\" },\n          { status: 403 }\n        );\n      }\n      \n      try {\n        await fs.access(absolutePath);\n      } catch {\n        return NextResponse.json(\n          { error: \"Path does not exist\" },\n          { status: 404 }\n        );\n      }\n      \n      const stat = await fs.stat(absolutePath);\n      if (!stat.isDirectory()) {\n        return NextResponse.json(\n          { error: \"Path is not a directory\" },\n          { status: 400 }\n        );\n      }\n      \n      // Check not duplicate (unless it's the same project)\n      const existing = await configService.getProjects();\n      const duplicate = existing.find(p =\u003e p.path === absolutePath \u0026\u0026 p.id !== id);\n      if (duplicate) {\n        return NextResponse.json(\n          { error: \"A project with this path already exists\" },\n          { status: 409 }\n        );\n      }\n      \n      updates.path = absolutePath;\n    }\n    \n    if (Object.keys(updates).length === 0) {\n      return NextResponse.json(\n        { error: \"No fields to update\" },\n        { status: 400 }\n      );\n    }\n    \n    const updated = await configService.updateProject(id, updates);\n    \n    return NextResponse.json({\n      id: updated.id,\n      path: updated.path,\n      displayPath: configService.toDisplayPath(updated.path),\n      name: updated.name,\n      displayName: updated.name ?? configService.deriveDisplayName(updated.path),\n      addedAt: updated.addedAt,\n      status: \"active\",\n    });\n    \n  } catch (error) {\n    console.error(\"Failed to update project:\", error);\n    return NextResponse.json(\n      { error: \"Failed to update project\" },\n      { status: 500 }\n    );\n  }\n}\n```\n\n## Relocation Workflow\nWhen a project goes missing:\n1. User sees warning in UI\n2. User clicks \"Relocate\"\n3. Folder browser opens (ideally at parent of old path if it exists, else ~/dev)\n4. User selects new location\n5. PATCH request with new path\n6. Project is now tracked at new location with same ID\n\nThe ID stays constant, preserving any bookmarks or links to `/project/[id]`.\n\n## Acceptance Criteria\n- [ ] Can update name only\n- [ ] Can update path only\n- [ ] Can update both name and path\n- [ ] Setting name to null reverts to derived name\n- [ ] Path validation (exists, is directory, in home, not duplicate)\n- [ ] Returns 404 for unknown project ID\n- [ ] Returns 400 when no updates provided\n- [ ] ID and addedAt are preserved on update\n\n## Dependencies\n- **Requires**: Task 1.1 (Config service)\n- **Requires**: Tasks 1.2 \u0026 1.3 (to have projects to update)\n\n## Files\n- `src/app/api/projects/[id]/route.ts` (new)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-30T07:55:02.980937-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:56:17.206082-06:00","dependencies":[{"issue_id":"maestro-slm.4","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:02.981357-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.5","title":"1.5 Implement DELETE /api/projects/[id] endpoint","description":"## Purpose\nImplement the `DELETE /api/projects/[id]` endpoint for removing projects from Maestro's tracking.\n\n## Important: Non-Destructive\nThis endpoint **only removes the project from Maestro's config**. It does NOT:\n- Delete any files on disk\n- Remove git history\n- Affect the project in any way\n\nThis is why no confirmation is required in the UI - it's trivially reversible by re-adding the project.\n\n## Response\n- **204 No Content**: Project successfully removed\n- **404 Not Found**: Project ID doesn't exist (still return 204 for idempotency? Design choice.)\n\nFor simplicity, return 204 even if project doesn't exist. This makes the operation idempotent - calling delete multiple times has the same effect as calling it once.\n\n## Implementation\n```typescript\n// src/app/api/projects/[id]/route.ts (add to existing file)\n\nexport async function DELETE(\n  request: Request,\n  { params }: { params: { id: string } }\n) {\n  try {\n    const { id } = params;\n    \n    await configService.deleteProject(id);\n    \n    return new NextResponse(null, { status: 204 });\n    \n  } catch (error) {\n    console.error(\"Failed to delete project:\", error);\n    return NextResponse.json(\n      { error: \"Failed to delete project\" },\n      { status: 500 }\n    );\n  }\n}\n```\n\nThe `configService.deleteProject(id)` should be idempotent - if project doesn't exist, it simply does nothing.\n\n## Use Cases\n1. **User removes a project they no longer want to track**\n2. **User removes a missing project** (can't relocate, just wants it gone)\n3. **Cleanup after project was deleted from disk** (via terminal, not Maestro)\n\n## Acceptance Criteria\n- [ ] Returns 204 on successful deletion\n- [ ] Returns 204 even if project doesn't exist (idempotent)\n- [ ] Project is removed from config.json\n- [ ] No files are deleted from disk\n- [ ] Returns 500 on unexpected errors (disk full, permissions, etc.)\n\n## Dependencies\n- **Requires**: Task 1.1 (Config service)\n- **Can parallel with**: Task 1.4 (PATCH endpoint)\n\n## Files\n- `src/app/api/projects/[id]/route.ts` (add DELETE handler)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-30T07:55:03.038099-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:56:26.042301-06:00","dependencies":[{"issue_id":"maestro-slm.5","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.038601-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.6","title":"2.1 Implement GET /api/filesystem/browse endpoint","description":"## Purpose\nImplement the `GET /api/filesystem/browse` endpoint for the folder picker UI. This enables users to navigate the server's filesystem to select project directories.\n\n## Why Custom Browsing?\nMaestro runs on the dev machine but is accessed remotely (via Tailscale from phone/tablet). Browser file picker APIs (`\u003cinput type=\"file\"\u003e`) open on the **client** device, not the server. We need a custom API that exposes the server's filesystem in a controlled way.\n\n## Security Constraints\n**Critical**: This endpoint exposes the filesystem. Security measures:\n1. **Home directory only** - Cannot browse outside `~`\n2. **Directories only** - Don't list files (irrelevant for project selection)\n3. **Hidden directories filtered** - No `.git`, `.config`, `.ssh`, etc.\n4. **Permission errors handled gracefully** - Skip unreadable dirs, don't fail\n\n## Query Parameters\n| Param | Required | Default | Description |\n|-------|----------|---------|-------------|\n| `path` | No | `~/dev` or `~` | Directory to list |\n\nIf `path` is not provided:\n- Try `~/dev` first (common convention)\n- Fall back to `~` if `~/dev` doesn't exist\n\n## Response Schema\n```typescript\ninterface BrowseResponse {\n  currentPath: string;    // Absolute: /Users/erik/dev\n  displayPath: string;    // Friendly: ~/dev\n  parent: string | null;  // Parent path, null if at home\n  canGoUp: boolean;       // false if at home directory\n  directories: Directory[];\n}\n\ninterface Directory {\n  name: string;           // Directory name\n  path: string;           // Absolute path\n  isGitRepo: boolean;     // Has .git subdirectory\n}\n```\n\n## Implementation\n```typescript\n// src/app/api/filesystem/browse/route.ts\nimport { NextResponse } from \"next/server\";\nimport { configService } from \"@/lib/services/config\";\nimport fs from \"fs/promises\";\nimport path from \"path\";\n\n// Directories to hide from listing\nconst HIDDEN_PATTERNS = [\n  /^\\./, // Hidden files/dirs (., .git, .config, etc.)\n  /^node_modules$/,\n  /^__pycache__$/,\n  /^\\.cache$/,\n  /^vendor$/,\n  /^\\.venv$/,\n  /^venv$/,\n];\n\nfunction shouldHide(name: string): boolean {\n  return HIDDEN_PATTERNS.some(pattern =\u003e pattern.test(name));\n}\n\nexport async function GET(request: Request) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const homeDir = configService.getHomeDir();\n    \n    // Determine path to browse\n    let browsePath = searchParams.get(\"path\");\n    \n    if (!browsePath) {\n      // Default: ~/dev if exists, else ~\n      const devPath = path.join(homeDir, \"dev\");\n      try {\n        await fs.access(devPath);\n        browsePath = devPath;\n      } catch {\n        browsePath = homeDir;\n      }\n    } else {\n      browsePath = configService.toAbsolutePath(browsePath);\n    }\n    \n    // Security: must be within home\n    if (!configService.isWithinHome(browsePath)) {\n      return NextResponse.json(\n        { error: \"Path must be within home directory\" },\n        { status: 403 }\n      );\n    }\n    \n    // Check path exists\n    try {\n      await fs.access(browsePath);\n    } catch {\n      return NextResponse.json(\n        { error: \"Path does not exist\" },\n        { status: 404 }\n      );\n    }\n    \n    // Check it's a directory\n    const stat = await fs.stat(browsePath);\n    if (!stat.isDirectory()) {\n      return NextResponse.json(\n        { error: \"Path is not a directory\" },\n        { status: 400 }\n      );\n    }\n    \n    // Read directory contents\n    const entries = await fs.readdir(browsePath, { withFileTypes: true });\n    \n    // Filter to visible directories only\n    const directories: Directory[] = [];\n    \n    for (const entry of entries) {\n      if (!entry.isDirectory()) continue;\n      if (shouldHide(entry.name)) continue;\n      \n      const entryPath = path.join(browsePath, entry.name);\n      \n      // Check if it's a git repo\n      let isGitRepo = false;\n      try {\n        await fs.access(path.join(entryPath, \".git\"));\n        isGitRepo = true;\n      } catch {\n        // Not a git repo, that's fine\n      }\n      \n      directories.push({\n        name: entry.name,\n        path: entryPath,\n        isGitRepo,\n      });\n    }\n    \n    // Sort alphabetically\n    directories.sort((a, b) =\u003e a.name.localeCompare(b.name));\n    \n    // Compute parent info\n    const parentPath = path.dirname(browsePath);\n    const isAtHome = browsePath === homeDir;\n    \n    return NextResponse.json({\n      currentPath: browsePath,\n      displayPath: configService.toDisplayPath(browsePath),\n      parent: isAtHome ? null : parentPath,\n      canGoUp: !isAtHome,\n      directories,\n    });\n    \n  } catch (error) {\n    console.error(\"Failed to browse filesystem:\", error);\n    return NextResponse.json(\n      { error: \"Failed to browse directory\" },\n      { status: 500 }\n    );\n  }\n}\n```\n\n## Git Repo Detection\nWe check for `.git` subdirectory to identify git repos. This helps users visually distinguish project directories from regular folders in the picker.\n\nNote: We intentionally skip `.git` in the listing (hidden pattern) but check for its existence to set `isGitRepo`.\n\n## Performance Considerations\n- Most dev directories have \u003c 50 items after filtering - performance is fine\n- Git detection adds one `fs.access` per directory - negligible overhead\n- For directories with many items, consider pagination (future enhancement)\n\n## Edge Cases\n- **Permission denied on subdirectory**: Skip it, don't fail the whole request\n- **Symlink directory**: Follow it, check resolved path is within home\n- **Race condition (dir deleted while reading)**: Skip missing entries gracefully\n- **Very deep nesting**: No limit enforced, but UI should handle long paths\n\n## Acceptance Criteria\n- [ ] Returns directories at requested path\n- [ ] Defaults to ~/dev (or ~ if no ~/dev)\n- [ ] Hides hidden directories (starting with .)\n- [ ] Hides node_modules, __pycache__, etc.\n- [ ] Shows isGitRepo indicator for git repos\n- [ ] Provides parent path for navigation\n- [ ] Returns canGoUp: false at home directory\n- [ ] Returns 403 for paths outside home\n- [ ] Returns 404 for non-existent paths\n- [ ] Handles permission errors gracefully\n\n## Dependencies\n- **Requires**: Task 1.1 (Config service for path utilities)\n- **Independent from**: Project CRUD endpoints\n\n## Files\n- `src/app/api/filesystem/browse/route.ts` (new)","status":"open","priority":0,"issue_type":"task","created_at":"2025-12-30T07:55:03.095579-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:56:50.833587-06:00","dependencies":[{"issue_id":"maestro-slm.6","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.096021-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.7","title":"3.1 Create FolderBrowser component - directory list with navigation","description":"## Purpose\nCreate the core FolderBrowser component that displays a navigable list of directories from the server filesystem. This is the main content area of the folder browser modal.\n\n## Component Structure\n```\nFolderBrowser/\nâ”œâ”€â”€ FolderBrowser.tsx      # Main component, manages navigation state\nâ”œâ”€â”€ DirectoryList.tsx      # Renders list of directories\nâ””â”€â”€ (Breadcrumbs.tsx)      # Separate task\n```\n\n## FolderBrowser Props\n```typescript\ninterface FolderBrowserProps {\n  onSelect?: (path: string) =\u003e void;  // Called when user clicks \"Select\" \n  initialPath?: string;               // Starting path (default: ~/dev or ~)\n}\n```\n\n## State Management\n```typescript\nconst [currentPath, setCurrentPath] = useState\u003cstring | undefined\u003e(initialPath);\nconst { data, isLoading, error } = useFilesystem(currentPath);\n```\n\nThe component maintains the current path and uses the useFilesystem hook to fetch directory contents. Navigation is handled by updating the currentPath state.\n\n## DirectoryList Component\n```typescript\ninterface DirectoryListProps {\n  directories: Directory[];\n  onNavigate: (path: string) =\u003e void;\n  isLoading?: boolean;\n}\n\nfunction DirectoryList({ directories, onNavigate, isLoading }: DirectoryListProps) {\n  if (isLoading) {\n    return \u003cDirectoryListSkeleton /\u003e;\n  }\n  \n  if (directories.length === 0) {\n    return (\n      \u003cdiv className=\"text-center py-8 text-muted-foreground\"\u003e\n        No subdirectories found\n      \u003c/div\u003e\n    );\n  }\n  \n  return (\n    \u003cdiv className=\"divide-y divide-border\"\u003e\n      {directories.map((dir) =\u003e (\n        \u003cbutton\n          key={dir.path}\n          onClick={() =\u003e onNavigate(dir.path)}\n          className=\"w-full flex items-center gap-3 px-3 py-2.5 hover:bg-secondary/50 transition-colors text-left\"\n        \u003e\n          \u003cFolder className=\"h-4 w-4 text-muted-foreground\" /\u003e\n          \u003cspan className=\"flex-1 truncate\"\u003e{dir.name}\u003c/span\u003e\n          {dir.isGitRepo \u0026\u0026 (\n            \u003cspan className=\"text-xs text-muted-foreground bg-secondary px-1.5 py-0.5 rounded\"\u003e\n              git\n            \u003c/span\u003e\n          )}\n          \u003cChevronRight className=\"h-4 w-4 text-muted-foreground\" /\u003e\n        \u003c/button\u003e\n      ))}\n    \u003c/div\u003e\n  );\n}\n```\n\n## Navigation Flow\n1. User clicks a directory â†’ `onNavigate(dir.path)` â†’ updates `currentPath`\n2. useFilesystem refetches with new path\n3. UI updates to show new directory contents\n4. Breadcrumbs update (separate component, same currentPath state)\n\n## Mobile Considerations\n- **Touch targets**: Minimum 44px height for directory items\n- **Scroll area**: Directory list should scroll independently, not the whole modal\n- **Loading state**: Show skeleton while navigating to prevent layout shift\n\n## Error Handling\n```typescript\nif (error) {\n  return (\n    \u003cdiv className=\"p-4 text-center\"\u003e\n      \u003cp className=\"text-destructive mb-2\"\u003eFailed to load directory\u003c/p\u003e\n      \u003cp className=\"text-sm text-muted-foreground mb-4\"\u003e{error.message}\u003c/p\u003e\n      \u003cButton variant=\"outline\" onClick={() =\u003e refetch()}\u003e\n        Retry\n      \u003c/Button\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n## Git Repo Indicator\nDirectories with `isGitRepo: true` show a small \"git\" badge. This helps users identify project directories vs regular folders.\n\n## Accessibility\n- Directory items are buttons with proper focus states\n- Keyboard navigation works (Tab, Enter)\n- Screen reader announces directory names and git status\n\n## Acceptance Criteria\n- [ ] Displays directories from useFilesystem hook\n- [ ] Clicking a directory navigates into it\n- [ ] Shows git repo indicator for git directories\n- [ ] Shows loading skeleton while fetching\n- [ ] Shows empty state when no subdirectories\n- [ ] Shows error state with retry option\n- [ ] Touch-friendly (44px+ tap targets)\n- [ ] Scrollable directory list\n\n## Dependencies\n- **Requires**: Task 7.1 (useFilesystem hook)\n- **Requires**: Task 2.1 (filesystem API endpoint)\n\n## Files\n- `src/components/folder-browser/FolderBrowser.tsx` (new)\n- `src/components/folder-browser/DirectoryList.tsx` (new)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-30T07:55:03.14827-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:57:30.770211-06:00","dependencies":[{"issue_id":"maestro-slm.7","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.148745-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.8","title":"3.2 Create FolderBrowser breadcrumb navigation","description":"## Purpose\nCreate the breadcrumb navigation component for the folder browser. Shows the current path as clickable segments, allowing users to jump to any parent directory.\n\n## Visual Design\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  ~ / dev / projects / my-app        [â†‘] â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n- Each segment is clickable\n- Current directory (last segment) is not clickable, just highlighted\n- \"Up\" button navigates to parent (same as clicking second-to-last segment)\n- On mobile, breadcrumbs scroll horizontally\n\n## Props\n```typescript\ninterface BreadcrumbsProps {\n  displayPath: string;       // e.g., \"~/dev/projects/my-app\"\n  onNavigate: (path: string) =\u003e void;\n  parent: string | null;     // Absolute path of parent, null if at home\n  canGoUp: boolean;\n}\n```\n\n## Implementation\n```typescript\n// src/components/folder-browser/Breadcrumbs.tsx\nimport { ChevronUp, Home } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\nexport function Breadcrumbs({ displayPath, onNavigate, parent, canGoUp }: BreadcrumbsProps) {\n  // Parse displayPath into segments\n  // \"~/dev/projects\" â†’ [\"~\", \"dev\", \"projects\"]\n  const segments = displayPath.split(\"/\").filter(Boolean);\n  \n  // Build absolute paths for each segment\n  // We need to map display paths back to absolute paths for navigation\n  // This requires knowing the home directory or receiving absolute paths\n  // For simplicity, receive absolutePath as well or compute from displayPath\n  \n  return (\n    \u003cdiv className=\"flex items-center gap-1 px-3 py-2 border-b border-border overflow-x-auto\"\u003e\n      {/* Scrollable breadcrumb container */}\n      \u003cdiv className=\"flex items-center gap-1 min-w-0 flex-1\"\u003e\n        {segments.map((segment, index) =\u003e {\n          const isLast = index === segments.length - 1;\n          const isHome = segment === \"~\";\n          \n          // Compute path for this segment\n          // \"~/dev/projects\" at index 1 (\"dev\") â†’ \"~/dev\" â†’ need absolute\n          // This is tricky - see implementation note below\n          \n          return (\n            \u003cdiv key={index} className=\"flex items-center\"\u003e\n              {index \u003e 0 \u0026\u0026 (\n                \u003cspan className=\"text-muted-foreground mx-1\"\u003e/\u003c/span\u003e\n              )}\n              {isLast ? (\n                \u003cspan className=\"font-medium truncate\"\u003e{segment}\u003c/span\u003e\n              ) : (\n                \u003cbutton\n                  onClick={() =\u003e onNavigate(pathForSegment)}\n                  className=\"text-muted-foreground hover:text-foreground transition-colors truncate\"\n                \u003e\n                  {isHome ? \u003cHome className=\"h-3.5 w-3.5\" /\u003e : segment}\n                \u003c/button\u003e\n              )}\n            \u003c/div\u003e\n          );\n        })}\n      \u003c/div\u003e\n      \n      {/* Up button */}\n      \u003cbutton\n        onClick={() =\u003e parent \u0026\u0026 onNavigate(parent)}\n        disabled={!canGoUp}\n        className={cn(\n          \"h-8 w-8 flex items-center justify-center rounded-md transition-colors\",\n          canGoUp \n            ? \"hover:bg-secondary text-muted-foreground hover:text-foreground\" \n            : \"text-muted-foreground/30 cursor-not-allowed\"\n        )}\n        aria-label=\"Go to parent directory\"\n      \u003e\n        \u003cChevronUp className=\"h-4 w-4\" /\u003e\n      \u003c/button\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n## Path Mapping Challenge\nThe displayPath is `~/dev/projects` but we need absolute paths for navigation. Solutions:\n\n1. **Pass absolutePath as prop** (recommended)\n   - FolderBrowser has both from useFilesystem response\n   - Breadcrumbs receives both and uses absolute for onClick\n\n2. **Reconstruct from segments**\n   - Replace `~` with home directory\n   - Join segments with `/`\n   - More brittle, assumes path format\n\nGoing with option 1:\n```typescript\ninterface BreadcrumbsProps {\n  currentPath: string;       // Absolute: /Users/erik/dev/projects\n  displayPath: string;       // Display: ~/dev/projects\n  onNavigate: (path: string) =\u003e void;\n  parent: string | null;\n  canGoUp: boolean;\n}\n```\n\nThen compute segment paths by walking back from currentPath.\n\n## Mobile Behavior\n- Container has `overflow-x-auto` for horizontal scroll\n- No explicit scroll indicators (browser native)\n- Current directory (last segment) should be visible - consider `scrollIntoView` on mount\n- Minimum touch target height maintained\n\n## Accessibility\n- Each segment is a button with proper focus state\n- Up button has aria-label\n- Disabled state properly announced\n\n## Acceptance Criteria\n- [ ] Shows path segments from displayPath\n- [ ] Clicking segment navigates to that directory\n- [ ] Last segment (current dir) is not clickable\n- [ ] Up button navigates to parent\n- [ ] Up button disabled at home directory\n- [ ] Horizontally scrollable on narrow screens\n- [ ] Home icon for ~ segment (optional, can be text)\n\n## Dependencies\n- **Used by**: Task 3.1 (FolderBrowser component)\n- **Requires**: Task 7.1 (useFilesystem hook data)\n\n## Files\n- `src/components/folder-browser/Breadcrumbs.tsx` (new)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-30T07:55:03.198729-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:57:52.672103-06:00","dependencies":[{"issue_id":"maestro-slm.8","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.199172-06:00","created_by":"daemon"}]}
{"id":"maestro-slm.9","title":"3.3 Create FolderBrowserModal with add project form","description":"## Purpose\nCreate the modal wrapper that contains the folder browser and the \"Add Project\" form. This is the complete UI for adding a new project to Maestro.\n\n## Visual Design\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚  Select Project Folder                      [X] â”‚  â† Header with close button\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  ~ / dev / my-project                       [â†‘] â”‚  â† Breadcrumbs\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚\nâ”‚  â”‚ [Paste path here...                   ] â”‚   â”‚  â† Path input (power user)\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  ğŸ“ api-gateway              git                â”‚  â† Directory list\nâ”‚  ğŸ“ frontend                 git                â”‚\nâ”‚  ğŸ“ scripts                                     â”‚\nâ”‚                                                 â”‚\nâ”‚              (scrollable area)                  â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  Name: [my-project              ] (optional)    â”‚  â† Custom name input\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚                    [Cancel]  [Add Project]      â”‚  â† Actions\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## Props\n```typescript\ninterface FolderBrowserModalProps {\n  open: boolean;\n  onOpenChange: (open: boolean) =\u003e void;\n  initialPath?: string;      // For \"Relocate\" flow, start at specific path\n  onSuccess?: () =\u003e void;    // Called after successful add\n}\n```\n\n## State\n```typescript\nconst [currentPath, setCurrentPath] = useState\u003cstring | undefined\u003e(initialPath);\nconst [selectedPath, setSelectedPath] = useState\u003cstring | null\u003e(null);\nconst [customName, setCustomName] = useState(\"\");\nconst [pathInput, setPathInput] = useState(\"\");\nconst [error, setError] = useState\u003cstring | null\u003e(null);\n\nconst { data: filesystem } = useFilesystem(currentPath);\nconst addProject = useAddProject();\n```\n\n## Interaction Flow\n\n### Navigating Directories\n1. User clicks directory in list\n2. `setCurrentPath(dir.path)` - navigates into directory\n3. useFilesystem refetches\n4. Breadcrumbs update\n\n### Selecting Current Directory\nThe current directory (shown in breadcrumbs) is implicitly selected. User can:\n1. Navigate to the project folder\n2. Optionally enter a custom name\n3. Click \"Add Project\"\n\n### Path Input (Power User Feature)\n- User can paste an absolute path directly\n- On Enter or blur, navigate to that path\n- Validates path via API (will show error if invalid)\n- Optional feature - can be omitted for v1\n\n### Custom Name\n- Text input pre-populated with current directory name\n- Empty â†’ use derived name (no custom name stored)\n- User can edit to set custom display name\n\n## Implementation\n```typescript\n// src/components/folder-browser/FolderBrowserModal.tsx\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { FolderBrowser } from \"./FolderBrowser\";\nimport { Breadcrumbs } from \"./Breadcrumbs\";\nimport { useAddProject } from \"@/lib/hooks/useProjects\";\nimport { useFilesystem } from \"@/lib/hooks/useFilesystem\";\n\nexport function FolderBrowserModal({ open, onOpenChange, initialPath, onSuccess }: FolderBrowserModalProps) {\n  const [currentPath, setCurrentPath] = useState\u003cstring | undefined\u003e(initialPath);\n  const [customName, setCustomName] = useState(\"\");\n  const [error, setError] = useState\u003cstring | null\u003e(null);\n  \n  const { data: filesystem, isLoading, error: browseError } = useFilesystem(currentPath);\n  const addProject = useAddProject();\n  \n  // Update custom name placeholder when path changes\n  useEffect(() =\u003e {\n    if (filesystem?.currentPath) {\n      const dirName = filesystem.currentPath.split(\"/\").pop() || \"\";\n      setCustomName(dirName);\n    }\n  }, [filesystem?.currentPath]);\n  \n  const handleAddProject = async () =\u003e {\n    if (!filesystem?.currentPath) return;\n    \n    setError(null);\n    try {\n      await addProject.mutateAsync({\n        path: filesystem.currentPath,\n        name: customName.trim() || undefined,\n      });\n      onOpenChange(false);\n      onSuccess?.();\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Failed to add project\");\n    }\n  };\n  \n  return (\n    \u003cDialog open={open} onOpenChange={onOpenChange}\u003e\n      \u003cDialogContent className=\"max-w-lg max-h-[80vh] flex flex-col p-0\"\u003e\n        \u003cDialogHeader className=\"px-4 py-3 border-b\"\u003e\n          \u003cDialogTitle\u003eSelect Project Folder\u003c/DialogTitle\u003e\n        \u003c/DialogHeader\u003e\n        \n        {/* Breadcrumbs */}\n        {filesystem \u0026\u0026 (\n          \u003cBreadcrumbs\n            currentPath={filesystem.currentPath}\n            displayPath={filesystem.displayPath}\n            onNavigate={setCurrentPath}\n            parent={filesystem.parent}\n            canGoUp={filesystem.canGoUp}\n          /\u003e\n        )}\n        \n        {/* Directory List */}\n        \u003cdiv className=\"flex-1 overflow-y-auto min-h-[200px]\"\u003e\n          \u003cFolderBrowser\n            currentPath={currentPath}\n            onNavigate={setCurrentPath}\n          /\u003e\n        \u003c/div\u003e\n        \n        {/* Custom Name Input */}\n        \u003cdiv className=\"px-4 py-3 border-t\"\u003e\n          \u003clabel className=\"text-sm text-muted-foreground mb-1.5 block\"\u003e\n            Display name (optional)\n          \u003c/label\u003e\n          \u003cInput\n            value={customName}\n            onChange={(e) =\u003e setCustomName(e.target.value)}\n            placeholder=\"Use folder name\"\n          /\u003e\n        \u003c/div\u003e\n        \n        {/* Error */}\n        {error \u0026\u0026 (\n          \u003cdiv className=\"px-4 py-2 text-sm text-destructive\"\u003e\n            {error}\n          \u003c/div\u003e\n        )}\n        \n        {/* Actions */}\n        \u003cdiv className=\"flex justify-end gap-2 px-4 py-3 border-t\"\u003e\n          \u003cButton variant=\"outline\" onClick={() =\u003e onOpenChange(false)}\u003e\n            Cancel\n          \u003c/Button\u003e\n          \u003cButton \n            onClick={handleAddProject}\n            disabled={!filesystem?.currentPath || addProject.isPending}\n          \u003e\n            {addProject.isPending ? \"Adding...\" : \"Add Project\"}\n          \u003c/Button\u003e\n        \u003c/div\u003e\n      \u003c/DialogContent\u003e\n    \u003c/Dialog\u003e\n  );\n}\n```\n\n## Mobile Behavior\n- Full screen modal on small screens (`sm:max-w-lg`)\n- Directory list takes available space, scrolls\n- Actions sticky at bottom\n- Touch-friendly inputs and buttons\n\n## Error Handling\n- Browse errors: Show in directory list area with retry\n- Add project errors: Show inline below name input\n- Clear error when navigating or retrying\n\n## Acceptance Criteria\n- [ ] Opens as modal dialog\n- [ ] Shows breadcrumbs with navigation\n- [ ] Shows directory list with navigation\n- [ ] Custom name input with folder name as placeholder\n- [ ] \"Add Project\" calls API with current path and name\n- [ ] Shows loading state during add\n- [ ] Shows error messages inline\n- [ ] Closes on success\n- [ ] Calls onSuccess callback on success\n- [ ] Cancel closes without action\n- [ ] Mobile-friendly layout\n\n## Dependencies\n- **Requires**: Task 3.1 (FolderBrowser component)\n- **Requires**: Task 3.2 (Breadcrumbs component)\n- **Requires**: Task 7.1 (useAddProject hook)\n- **Requires**: shadcn Dialog component (may need to add)\n\n## Files\n- `src/components/folder-browser/FolderBrowserModal.tsx` (new)\n- May need: `src/components/ui/dialog.tsx` (shadcn component)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-30T07:55:03.250446-06:00","created_by":"erikjohansson","updated_at":"2025-12-30T07:58:20.72365-06:00","dependencies":[{"issue_id":"maestro-slm.9","depends_on_id":"maestro-slm","type":"parent-child","created_at":"2025-12-30T07:55:03.250911-06:00","created_by":"daemon"}]}
